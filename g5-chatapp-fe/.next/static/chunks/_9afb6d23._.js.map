{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://D%3A/cnm_ws/cnm_project_24_25/g5-chatapp-fe/app/%28root%29/conversations/%5BconversationId%5D/_components/Header.tsx"],"sourcesContent":["import { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Card } from \"@/components/ui/card\";\r\n// import {\r\n//   DropdownMenu,\r\n//   DropdownMenuContent,\r\n//   DropdownMenuItem,\r\n//   DropdownMenuTrigger,\r\n// } from \"@/components/ui/dropdown-menu\";\r\nimport { cn, getInitials, getNameFallBack } from \"@/lib/utils\";\r\nimport { useAuthStore } from \"@/store/useAuthStore\";\r\nimport { useCallStore } from \"@/store/useCallStore\";\r\nimport { useConversationStore } from \"@/store/useConversationStore\";\r\nimport { CircleArrowLeft, Settings, User, User2Icon } from \"lucide-react\";\r\nimport Link from \"next/link\";\r\nimport React, { useEffect } from \"react\";\r\n\r\ntype Props = {\r\n  isGroup: boolean;\r\n  name?: string;\r\n  numMembers?: number;\r\n  userId?: string;\r\n  imageUrl?: string;\r\n  firstName?: string;\r\n  lastName?: string;\r\n  options?: {\r\n    label: string;\r\n    icon?: React.ReactNode;\r\n    onClick: () => void;\r\n  }[];\r\n};\r\n\r\nconst Header = ({\r\n  isGroup,\r\n  name,\r\n  numMembers,\r\n  userId,\r\n  imageUrl,\r\n  firstName,\r\n  lastName,\r\n  options,\r\n}: Props) => {\r\n  const { activeUsers } = useAuthStore();\r\n  const { handleCall } = useCallStore();\r\n  const [isOnline, setIsOnline] = React.useState(false);\r\n  useEffect(() => {\r\n    console.log(\"userSelected\", userId);\r\n    if (!userId || isGroup) return;\r\n    console.log(\"activeUsers\", activeUsers);\r\n    const isUserOnline = activeUsers.includes(userId);\r\n    console.log(\"isUserOnline\", isUserOnline);\r\n    setIsOnline(isUserOnline);\r\n  }, [activeUsers, userId]);\r\n\r\n  return (\r\n    <Card className=\"w-full flex rounded-lg items-center p-2 justify-between\">\r\n      <div className=\"flex items-center gap-2\">\r\n        <Link href=\"/conversations\" className=\"block lg:hidden\">\r\n          <CircleArrowLeft />\r\n        </Link>\r\n        <Avatar className=\"h-8 w-8\">\r\n          {isGroup ? (\r\n            <AvatarImage src={imageUrl || \"/group.jpg\"} alt={firstName} />\r\n          ) : (\r\n            <AvatarImage src={imageUrl || \"/avatar.png\"} alt={firstName} />\r\n          )}\r\n          <AvatarFallback>\r\n            {getNameFallBack(firstName || \"\", lastName || \"\")}\r\n          </AvatarFallback>\r\n        </Avatar>\r\n        <div>\r\n          {isGroup ? (\r\n            <h2 className=\"font-semibold\">{name}</h2>\r\n          ) : (\r\n            <h2 className=\"font-semibold\">{firstName + \" \" + lastName}</h2>\r\n          )}\r\n          {isGroup && numMembers ? (\r\n            <div className=\"flex items-center text-xs text-muted-foreground\">\r\n              <User2Icon size={12} /> \r\n              <span className=\"ml-1\">{numMembers} members</span>\r\n            </div>\r\n          ) : (\r\n            <p className=\"text-sm text-muted-foreground flex items-center gap-1\">\r\n              {isOnline ? (\r\n                <span className=\"h-2 w-2 rounded-full bg-green-500\" />\r\n              ) : (\r\n                <span className=\"h-2 w-2 rounded-full bg-red-500\" />\r\n              )}\r\n              {isOnline ? \"Online\" : \"Offline\"}\r\n            </p>\r\n          )}\r\n        </div>\r\n      </div>\r\n      <div className=\"flex gap-2\">\r\n        {options &&\r\n          options.map((option, index) => {\r\n            return (\r\n              <Button\r\n                key={index}\r\n                size={\"icon\"}\r\n                variant={\"ghost\"}\r\n                onClick={option.onClick}\r\n              >\r\n                {option.icon}\r\n              </Button>\r\n            );\r\n          })}\r\n        {/* {options && (\r\n          <DropdownMenu>\r\n            <DropdownMenuTrigger>\r\n              <Button size={\"icon\"} variant={\"secondary\"}>\r\n                <Settings />\r\n              </Button>\r\n            </DropdownMenuTrigger>\r\n            <DropdownMenuContent>\r\n              {options.map((option, index) => {\r\n                return (\r\n                  <DropdownMenuItem\r\n                    key={index}\r\n                    onClick={option.onClick}\r\n                    className={cn(\"font-semibold\", {\r\n                      \"text-destructive\": option.destructive,\r\n                    })}\r\n                  >\r\n                    {option.label}\r\n                  </DropdownMenuItem>\r\n                );\r\n              })}\r\n            </DropdownMenuContent>\r\n          </DropdownMenu>\r\n        )} */}\r\n      </div>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default Header;\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA,WAAW;AACX,kBAAkB;AAClB,yBAAyB;AACzB,sBAAsB;AACtB,yBAAyB;AACzB,0CAA0C;AAC1C;AACA;AACA;AAEA;AAAA;AACA;AACA;;;;;;;;;;;;AAiBA,MAAM,SAAS,CAAC,EACd,OAAO,EACP,IAAI,EACJ,UAAU,EACV,MAAM,EACN,QAAQ,EACR,SAAS,EACT,QAAQ,EACR,OAAO,EACD;;IACN,MAAM,EAAE,WAAW,EAAE,GAAG,CAAA,GAAA,wHAAA,CAAA,eAAY,AAAD;IACnC,MAAM,EAAE,UAAU,EAAE,GAAG,CAAA,GAAA,wHAAA,CAAA,eAAY,AAAD;IAClC,MAAM,CAAC,UAAU,YAAY,GAAG,6JAAA,CAAA,UAAK,CAAC,QAAQ,CAAC;IAC/C,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;4BAAE;YACR,QAAQ,GAAG,CAAC,gBAAgB;YAC5B,IAAI,CAAC,UAAU,SAAS;YACxB,QAAQ,GAAG,CAAC,eAAe;YAC3B,MAAM,eAAe,YAAY,QAAQ,CAAC;YAC1C,QAAQ,GAAG,CAAC,gBAAgB;YAC5B,YAAY;QACd;2BAAG;QAAC;QAAa;KAAO;IAExB,qBACE,6LAAC,4HAAA,CAAA,OAAI;QAAC,WAAU;;0BACd,6LAAC;gBAAI,WAAU;;kCACb,6LAAC,+JAAA,CAAA,UAAI;wBAAC,MAAK;wBAAiB,WAAU;kCACpC,cAAA,6LAAC,mOAAA,CAAA,kBAAe;;;;;;;;;;kCAElB,6LAAC,8HAAA,CAAA,SAAM;wBAAC,WAAU;;4BACf,wBACC,6LAAC,8HAAA,CAAA,cAAW;gCAAC,KAAK,YAAY;gCAAc,KAAK;;;;;qDAEjD,6LAAC,8HAAA,CAAA,cAAW;gCAAC,KAAK,YAAY;gCAAe,KAAK;;;;;;0CAEpD,6LAAC,8HAAA,CAAA,iBAAc;0CACZ,CAAA,GAAA,+GAAA,CAAA,kBAAe,AAAD,EAAE,aAAa,IAAI,YAAY;;;;;;;;;;;;kCAGlD,6LAAC;;4BACE,wBACC,6LAAC;gCAAG,WAAU;0CAAiB;;;;;qDAE/B,6LAAC;gCAAG,WAAU;0CAAiB,YAAY,MAAM;;;;;;4BAElD,WAAW,2BACV,6LAAC;gCAAI,WAAU;;kDACb,6LAAC,mNAAA,CAAA,YAAS;wCAAC,MAAM;;;;;;kDACjB,6LAAC;wCAAK,WAAU;;4CAAQ;4CAAW;;;;;;;;;;;;qDAGrC,6LAAC;gCAAE,WAAU;;oCACV,yBACC,6LAAC;wCAAK,WAAU;;;;;6DAEhB,6LAAC;wCAAK,WAAU;;;;;;oCAEjB,WAAW,WAAW;;;;;;;;;;;;;;;;;;;0BAK/B,6LAAC;gBAAI,WAAU;0BACZ,WACC,QAAQ,GAAG,CAAC,CAAC,QAAQ;oBACnB,qBACE,6LAAC,8HAAA,CAAA,SAAM;wBAEL,MAAM;wBACN,SAAS;wBACT,SAAS,OAAO,OAAO;kCAEtB,OAAO,IAAI;uBALP;;;;;gBAQX;;;;;;;;;;;;AA4BV;GAtGM;;QAUoB,wHAAA,CAAA,eAAY;QACb,wHAAA,CAAA,eAAY;;;KAX/B;uCAwGS","debugId":null}},
    {"offset": {"line": 229, "column": 0}, "map": {"version":3,"sources":["file://D%3A/cnm_ws/cnm_project_24_25/g5-chatapp-fe/components/common/dialog/ForwardMessageDialog.tsx"],"sourcesContent":["\"use client\";\r\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport {\r\n  Dialog,\r\n  DialogClose,\r\n  DialogContent,\r\n  DialogFooter,\r\n  DialogTitle,\r\n  DialogTrigger,\r\n} from \"@/components/ui/dialog\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { useAuthStore } from \"@/store/useAuthStore\";\r\nimport { useConversationStore } from \"@/store/useConversationStore\";\r\nimport { useMessageStore } from \"@/store/useMessageStore\";\r\nimport { Conversation, Message } from \"@/types\";\r\nimport { Forward } from \"lucide-react\";\r\nimport React, { useState } from \"react\";\r\nimport { toast } from \"sonner\";\r\n\r\ntype Props = {\r\n  messageToForward: Message | null;\r\n};\r\n\r\nconst ForwardMessageDialog = ({ messageToForward }: Props) => {\r\n  const { getConversations, conversations, selectedConversation } =\r\n    useConversationStore();\r\n  const { forwardMessage } = useMessageStore();\r\n  const [inputValue, setInputValue] = React.useState(\"\");\r\n  const { user } = useAuthStore();\r\n  const [selectedConversationId, setSelectedConversationId] = useState<\r\n    String[]\r\n  >([]);\r\n\r\n  const getMemberName = (conversation: Conversation) => {\r\n    if (conversation.members[0].user._id !== user?.id) {\r\n      return (\r\n        conversation.members[0].user.firstName +\r\n        \" \" +\r\n        conversation.members[0].user.lastName\r\n      );\r\n    }\r\n    return (\r\n      conversation.members[1].user.firstName +\r\n      \" \" +\r\n      conversation.members[1].user.lastName\r\n    );\r\n  };\r\n\r\n  const filterConversations = () => {\r\n    return conversations.filter((conversation) => {\r\n      // Bỏ qua cuộc trò chuyện đang được chọn\r\n      if (conversation._id === selectedConversation?._id) {\r\n        return false;\r\n      }\r\n\r\n      // Nếu không có input, trả về tất cả trừ selectedConversation\r\n      if (inputValue.length === 0) {\r\n        return true;\r\n      }\r\n\r\n      const memberName = getMemberName(conversation).toLowerCase();\r\n      return memberName.includes(inputValue.toLowerCase());\r\n    });\r\n  };\r\n\r\n  const filteredConversations = filterConversations();\r\n\r\n  const getAvatarUrl = (conversation: Conversation) => {\r\n    if (conversation.members[0].user._id !== user?.id) {\r\n      return conversation.members[0].user.avatar;\r\n    }\r\n    return conversation.members[1].user.avatar;\r\n  };\r\n\r\n  const handleForwardMessage = async () => {\r\n    if (messageToForward) {\r\n      if (selectedConversationId.length < 1) {\r\n        toast.error(\"Please select at least one conversation to forward\");\r\n        return;\r\n      }\r\n      forwardMessage(messageToForward._id, selectedConversationId as string[]);\r\n    }\r\n  };\r\n  return (\r\n    <Dialog>\r\n      <DialogTrigger asChild>\r\n        <Button\r\n          variant=\"ghost\"\r\n          size=\"icon\"\r\n          className=\"rounded-full size-8 bg-background shadow-sm hover:bg-muted\"\r\n        >\r\n          <Forward className=\"size-4\" />\r\n        </Button>\r\n      </DialogTrigger>\r\n      <DialogContent className=\"sm:max-w-[400px] h-[60vh] p-0 \">\r\n        <div className=\"flex flex-col h-full\">\r\n          {/* Header */}\r\n          <div className=\"flex items-center justify-between px-4 py-3 border-b\">\r\n            <DialogTitle className=\"text-base font-semibold\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <Forward className=\"size-4\" />\r\n                Forward message\r\n              </div>\r\n            </DialogTitle>\r\n          </div>\r\n\r\n          {/* Input */}\r\n          <div className=\"p-4\">\r\n            <Input\r\n              placeholder=\"User name\"\r\n              value={inputValue}\r\n              onChange={(e) => setInputValue(e.target.value)}\r\n              className=\"bg-gray-100\"\r\n            />\r\n          </div>\r\n          {/* result */}\r\n          <div className=\"h-[240px] overflow-y-scroll no-scrollbar\">\r\n            {filteredConversations &&\r\n              filteredConversations.length > 0 &&\r\n              filteredConversations.map((conversation) => (\r\n                <div\r\n                  key={conversation._id}\r\n                  className=\"flex items-center justify-between gap-2 p-4 border-b border-base-300\"\r\n                >\r\n                  {conversation.isGroup ? (\r\n                    <div className=\"flex items-center gap-2\">\r\n                      {/* <img\r\n                      src={user.avatar || \"/avatar.png\"}\r\n                      alt={user.firstName + \" \" + user.lastName}\r\n                      className=\"w-10 h-10 rounded-full\"\r\n                    /> */}\r\n                      <Avatar>\r\n                        <AvatarImage\r\n                          src={conversation.profilePicture || \"/group.jpg\"}\r\n                        ></AvatarImage>\r\n                        <AvatarFallback></AvatarFallback>\r\n                      </Avatar>\r\n                      <div>\r\n                        <p className=\"text-sm font-semibold\">\r\n                          {conversation.name}\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n                  ) : (\r\n                    <div className=\"flex items-center gap-2\">\r\n                      {/* <img\r\n                      src={user.avatar || \"/avatar.png\"}\r\n                      alt={user.firstName + \" \" + user.lastName}\r\n                      className=\"w-10 h-10 rounded-full\"\r\n                    /> */}\r\n                      <Avatar>\r\n                        <AvatarImage\r\n                          src={getAvatarUrl(conversation) || \"/avatar.png\"}\r\n                        ></AvatarImage>\r\n                        <AvatarFallback></AvatarFallback>\r\n                      </Avatar>\r\n                      <div>\r\n                        <p className=\"text-sm font-semibold\">\r\n                          {getMemberName(conversation)}\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <input\r\n                      type=\"checkbox\"\r\n                      checked={selectedConversationId.includes(\r\n                        conversation._id\r\n                      )}\r\n                      onChange={(e) => {\r\n                        if (e.target.checked) {\r\n                          setSelectedConversationId((prev) => [\r\n                            ...prev,\r\n                            conversation._id,\r\n                          ]);\r\n                        } else {\r\n                          setSelectedConversationId((prev) =>\r\n                            prev.filter((id) => id !== conversation._id)\r\n                          );\r\n                        }\r\n                      }}\r\n                      className=\"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n              ))}\r\n          </div>\r\n\r\n          {/* Footer */}\r\n          <DialogFooter className=\"bg-gray-50 px-4 py-3 border-t flex justify-end gap-2\">\r\n            <DialogClose asChild>\r\n              <Button variant=\"ghost\">Cancel</Button>\r\n            </DialogClose>\r\n            <Button onClick={handleForwardMessage}>Forward</Button>\r\n          </DialogFooter>\r\n        </div>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default ForwardMessageDialog;\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 574, "column": 0}, "map": {"version":3,"sources":["file://D%3A/cnm_ws/cnm_project_24_25/g5-chatapp-fe/app/%28root%29/conversations/%5BconversationId%5D/_components/body/ImageGallery.tsx"],"sourcesContent":["\"use client\";\r\nimport React, { useState } from \"react\";\r\nimport {\r\n  Dialog,\r\n  DialogClose,\r\n  DialogContent,\r\n  DialogTitle,\r\n} from \"@/components/ui/dialog\";\r\nimport { X } from \"lucide-react\";\r\n\r\ntype ImageInfo = {\r\n  url: string;\r\n  fileName: string;\r\n};\r\n\r\ntype Size = {\r\n  width: number;\r\n  height: number;\r\n};\r\n\r\ntype ImageGalleryProps = {\r\n  images: ImageInfo[];\r\n  sizes?: Size[];\r\n  content?: string;\r\n};\r\n\r\nconst ImageGallery: React.FC<ImageGalleryProps> = ({\r\n  images,\r\n  sizes = [],\r\n  content,\r\n}) => {\r\n  const [selectedImage, setSelectedImage] = useState<ImageInfo | null>(null);\r\n\r\n  const handleClick = (img: ImageInfo) => {\r\n    setSelectedImage(img);\r\n  };\r\n\r\n  const renderImages = () => {\r\n    const count = images.length;\r\n\r\n    const ImageItem = (img: ImageInfo, i: number) => (\r\n      <img\r\n        key={i}\r\n        src={img.url}\r\n        alt={img.fileName}\r\n        onClick={() => handleClick(img)}\r\n        className=\"rounded-lg object-cover border w-full h-36 cursor-pointer hover:brightness-90 transition\"\r\n      />\r\n    );\r\n\r\n    if (count === 1) {\r\n      return (\r\n        <img\r\n          src={images[0].url}\r\n          alt={images[0].fileName}\r\n          onClick={() => handleClick(images[0])}\r\n          className=\"rounded-lg object-cover border w-full max-w-md cursor-pointer hover:brightness-90 transition\"\r\n        />\r\n      );\r\n    }\r\n\r\n    if (count === 2) {\r\n      return (\r\n        <div className=\"grid grid-cols-2 gap-2\">\r\n          {images.map((img, i) => ImageItem(img, i))}\r\n        </div>\r\n      );\r\n    }\r\n\r\n    if (count === 3) {\r\n      return (\r\n        <div className=\"flex flex-col gap-2\">\r\n          <div className=\"grid grid-cols-2 gap-2\">\r\n            {images.slice(0, 2).map((img, i) => ImageItem(img, i))}\r\n          </div>\r\n          {ImageItem(images[2], 2)}\r\n        </div>\r\n      );\r\n    }\r\n\r\n    // 4 ảnh trở lên\r\n    return (\r\n      <div className=\"grid grid-cols-2 gap-2\">\r\n        {images.map((img, i) => ImageItem(img, i))}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <div className=\"flex flex-col gap-2\">\r\n        {renderImages()}\r\n        {content && (\r\n          <p className=\"text-wrap break-words whitespace-pre-wrap mt-2\">\r\n            {content}\r\n          </p>\r\n        )}\r\n      </div>\r\n\r\n      <Dialog\r\n        open={!!selectedImage}\r\n        onOpenChange={() => setSelectedImage(null)}\r\n      >\r\n        <DialogContent className=\"max-w-4xl p-0 bg-transparent border-none shadow-none [&>button[data-dialog-close]]:hidden\">\r\n          <DialogTitle>\r\n            {/* <VisuallyHidden>Image preview</VisuallyHidden> */}\r\n          </DialogTitle>\r\n          <DialogClose className=\"absolute top-2 right-2 text-white bg-black hover:bg-black/80 rounded-full p-1 transition\">\r\n            <X className=\"w-5 h-5\" />\r\n          </DialogClose>\r\n          {selectedImage && (\r\n            <img\r\n              src={selectedImage.url}\r\n              alt={selectedImage.fileName}\r\n              className=\"w-full h-auto max-h-[80vh] object-contain rounded-lg\"\r\n            />\r\n          )}\r\n        </DialogContent>\r\n      </Dialog>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default ImageGallery;\r\n"],"names":[],"mappings":";;;;AACA;AACA;AAMA;;;AARA;;;;AA0BA,MAAM,eAA4C,CAAC,EACjD,MAAM,EACN,QAAQ,EAAE,EACV,OAAO,EACR;;IACC,MAAM,CAAC,eAAe,iBAAiB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAoB;IAErE,MAAM,cAAc,CAAC;QACnB,iBAAiB;IACnB;IAEA,MAAM,eAAe;QACnB,MAAM,QAAQ,OAAO,MAAM;QAE3B,MAAM,YAAY,CAAC,KAAgB,kBACjC,6LAAC;gBAEC,KAAK,IAAI,GAAG;gBACZ,KAAK,IAAI,QAAQ;gBACjB,SAAS,IAAM,YAAY;gBAC3B,WAAU;eAJL;;;;;QAQT,IAAI,UAAU,GAAG;YACf,qBACE,6LAAC;gBACC,KAAK,MAAM,CAAC,EAAE,CAAC,GAAG;gBAClB,KAAK,MAAM,CAAC,EAAE,CAAC,QAAQ;gBACvB,SAAS,IAAM,YAAY,MAAM,CAAC,EAAE;gBACpC,WAAU;;;;;;QAGhB;QAEA,IAAI,UAAU,GAAG;YACf,qBACE,6LAAC;gBAAI,WAAU;0BACZ,OAAO,GAAG,CAAC,CAAC,KAAK,IAAM,UAAU,KAAK;;;;;;QAG7C;QAEA,IAAI,UAAU,GAAG;YACf,qBACE,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;kCACZ,OAAO,KAAK,CAAC,GAAG,GAAG,GAAG,CAAC,CAAC,KAAK,IAAM,UAAU,KAAK;;;;;;oBAEpD,UAAU,MAAM,CAAC,EAAE,EAAE;;;;;;;QAG5B;QAEA,gBAAgB;QAChB,qBACE,6LAAC;YAAI,WAAU;sBACZ,OAAO,GAAG,CAAC,CAAC,KAAK,IAAM,UAAU,KAAK;;;;;;IAG7C;IAEA,qBACE;;0BACE,6LAAC;gBAAI,WAAU;;oBACZ;oBACA,yBACC,6LAAC;wBAAE,WAAU;kCACV;;;;;;;;;;;;0BAKP,6LAAC,8HAAA,CAAA,SAAM;gBACL,MAAM,CAAC,CAAC;gBACR,cAAc,IAAM,iBAAiB;0BAErC,cAAA,6LAAC,8HAAA,CAAA,gBAAa;oBAAC,WAAU;;sCACvB,6LAAC,8HAAA,CAAA,cAAW;;;;;sCAGZ,6LAAC,8HAAA,CAAA,cAAW;4BAAC,WAAU;sCACrB,cAAA,6LAAC,+LAAA,CAAA,IAAC;gCAAC,WAAU;;;;;;;;;;;wBAEd,+BACC,6LAAC;4BACC,KAAK,cAAc,GAAG;4BACtB,KAAK,cAAc,QAAQ;4BAC3B,WAAU;;;;;;;;;;;;;;;;;;;AAOxB;GA/FM;KAAA;uCAiGS","debugId":null}},
    {"offset": {"line": 739, "column": 0}, "map": {"version":3,"sources":["file://D%3A/cnm_ws/cnm_project_24_25/g5-chatapp-fe/components/ui/dropdown-menu.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport * as React from \"react\"\r\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\r\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst DropdownMenu = DropdownMenuPrimitive.Root\r\n\r\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\r\n\r\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\r\n\r\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\r\n\r\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\r\n\r\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\r\n\r\nconst DropdownMenuSubTrigger = React.forwardRef<\r\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\r\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\r\n    inset?: boolean\r\n  }\r\n>(({ className, inset, children, ...props }, ref) => (\r\n  <DropdownMenuPrimitive.SubTrigger\r\n    ref={ref}\r\n    className={cn(\r\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\r\n      inset && \"pl-8\",\r\n      className\r\n    )}\r\n    {...props}\r\n  >\r\n    {children}\r\n    <ChevronRight className=\"ml-auto\" />\r\n  </DropdownMenuPrimitive.SubTrigger>\r\n))\r\nDropdownMenuSubTrigger.displayName =\r\n  DropdownMenuPrimitive.SubTrigger.displayName\r\n\r\nconst DropdownMenuSubContent = React.forwardRef<\r\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\r\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\r\n>(({ className, ...props }, ref) => (\r\n  <DropdownMenuPrimitive.SubContent\r\n    ref={ref}\r\n    className={cn(\r\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nDropdownMenuSubContent.displayName =\r\n  DropdownMenuPrimitive.SubContent.displayName\r\n\r\nconst DropdownMenuContent = React.forwardRef<\r\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\r\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\r\n>(({ className, sideOffset = 4, ...props }, ref) => (\r\n  <DropdownMenuPrimitive.Portal>\r\n    <DropdownMenuPrimitive.Content\r\n      ref={ref}\r\n      sideOffset={sideOffset}\r\n      className={cn(\r\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  </DropdownMenuPrimitive.Portal>\r\n))\r\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\r\n\r\nconst DropdownMenuItem = React.forwardRef<\r\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\r\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\r\n    inset?: boolean\r\n  }\r\n>(({ className, inset, ...props }, ref) => (\r\n  <DropdownMenuPrimitive.Item\r\n    ref={ref}\r\n    className={cn(\r\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\r\n      inset && \"pl-8\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\r\n\r\nconst DropdownMenuCheckboxItem = React.forwardRef<\r\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\r\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\r\n>(({ className, children, checked, ...props }, ref) => (\r\n  <DropdownMenuPrimitive.CheckboxItem\r\n    ref={ref}\r\n    className={cn(\r\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\r\n      className\r\n    )}\r\n    checked={checked}\r\n    {...props}\r\n  >\r\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\r\n      <DropdownMenuPrimitive.ItemIndicator>\r\n        <Check className=\"h-4 w-4\" />\r\n      </DropdownMenuPrimitive.ItemIndicator>\r\n    </span>\r\n    {children}\r\n  </DropdownMenuPrimitive.CheckboxItem>\r\n))\r\nDropdownMenuCheckboxItem.displayName =\r\n  DropdownMenuPrimitive.CheckboxItem.displayName\r\n\r\nconst DropdownMenuRadioItem = React.forwardRef<\r\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\r\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\r\n>(({ className, children, ...props }, ref) => (\r\n  <DropdownMenuPrimitive.RadioItem\r\n    ref={ref}\r\n    className={cn(\r\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\r\n      className\r\n    )}\r\n    {...props}\r\n  >\r\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\r\n      <DropdownMenuPrimitive.ItemIndicator>\r\n        <Circle className=\"h-2 w-2 fill-current\" />\r\n      </DropdownMenuPrimitive.ItemIndicator>\r\n    </span>\r\n    {children}\r\n  </DropdownMenuPrimitive.RadioItem>\r\n))\r\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\r\n\r\nconst DropdownMenuLabel = React.forwardRef<\r\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\r\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\r\n    inset?: boolean\r\n  }\r\n>(({ className, inset, ...props }, ref) => (\r\n  <DropdownMenuPrimitive.Label\r\n    ref={ref}\r\n    className={cn(\r\n      \"px-2 py-1.5 text-sm font-semibold\",\r\n      inset && \"pl-8\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\r\n\r\nconst DropdownMenuSeparator = React.forwardRef<\r\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\r\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\r\n>(({ className, ...props }, ref) => (\r\n  <DropdownMenuPrimitive.Separator\r\n    ref={ref}\r\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\r\n    {...props}\r\n  />\r\n))\r\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\r\n\r\nconst DropdownMenuShortcut = ({\r\n  className,\r\n  ...props\r\n}: React.HTMLAttributes<HTMLSpanElement>) => {\r\n  return (\r\n    <span\r\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\r\n\r\nexport {\r\n  DropdownMenu,\r\n  DropdownMenuTrigger,\r\n  DropdownMenuContent,\r\n  DropdownMenuItem,\r\n  DropdownMenuCheckboxItem,\r\n  DropdownMenuRadioItem,\r\n  DropdownMenuLabel,\r\n  DropdownMenuSeparator,\r\n  DropdownMenuShortcut,\r\n  DropdownMenuGroup,\r\n  DropdownMenuPortal,\r\n  DropdownMenuSub,\r\n  DropdownMenuSubContent,\r\n  DropdownMenuSubTrigger,\r\n  DropdownMenuRadioGroup,\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 967, "column": 0}, "map": {"version":3,"sources":["file://D%3A/cnm_ws/cnm_project_24_25/g5-chatapp-fe/app/%28root%29/conversations/%5BconversationId%5D/_components/body/MessageOption.tsx"],"sourcesContent":["import { MessageCircleX, Trash2 } from \"lucide-react\";\r\n\r\nimport { Button } from \"@/components/ui/button\";\r\nimport {\r\n  DropdownMenu,\r\n  DropdownMenuContent,\r\n  DropdownMenuItem,\r\n  DropdownMenuTrigger,\r\n} from \"@/components/ui/dropdown-menu\";\r\nimport { Separator } from \"@/components/ui/separator\";\r\nimport { useMessageStore } from \"@/store/useMessageStore\";\r\nimport { Message } from \"@/types\";\r\nimport { useAuthStore } from \"@/store/useAuthStore\";\r\n\r\ntype Props = {\r\n  message: Message;\r\n  setIsDropdownOpen: (isOpen: boolean) => void;\r\n  setIsHovered: (isHovered: boolean) => void;\r\n};\r\n\r\nexport function MessageOption({\r\n  message,\r\n  setIsDropdownOpen,\r\n  setIsHovered,\r\n}: Props) {\r\n  const { deleteMessage, revokeMessage } = useMessageStore();\r\n  const { user } = useAuthStore();\r\n  return (\r\n    <DropdownMenu\r\n      onOpenChange={(open) => {\r\n        setIsDropdownOpen(open);\r\n        if (!open) {\r\n          setIsHovered(false);\r\n        }\r\n      }}\r\n    >\r\n      <DropdownMenuTrigger asChild>\r\n        <Button\r\n          variant=\"ghost\"\r\n          size=\"icon\"\r\n          className=\"rounded-full size-8 bg-background shadow-sm hover:bg-muted\"\r\n        >\r\n          <svg className=\"size-4\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\r\n            <circle cx=\"12\" cy=\"12\" r=\"2\" />\r\n            <circle cx=\"6\" cy=\"12\" r=\"2\" />\r\n            <circle cx=\"18\" cy=\"12\" r=\"2\" />\r\n          </svg>\r\n        </Button>\r\n      </DropdownMenuTrigger>\r\n      <DropdownMenuContent className=\"w-56 z-[999]\">\r\n        {message.sender._id === user?.id && (\r\n          <>\r\n            <DropdownMenuItem>\r\n              <button\r\n                className=\"flex items-center gap-2 text-red-500 w-full\"\r\n                onClick={() => revokeMessage(message)}\r\n              >\r\n                <MessageCircleX className=\"size-4\" />\r\n                <span>Recall</span>\r\n              </button>\r\n            </DropdownMenuItem>\r\n            <Separator />\r\n          </>\r\n        )}\r\n        <DropdownMenuItem>\r\n          <button\r\n            className=\"flex items-center gap-2 text-red-500 w-full\"\r\n            onClick={() => deleteMessage(message)}\r\n          >\r\n            <Trash2 className=\"size-4\" />\r\n            <span>Delete for me only</span>\r\n          </button>\r\n        </DropdownMenuItem>\r\n      </DropdownMenuContent>\r\n    </DropdownMenu>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AAAA;AAEA;AACA;AAMA;AACA;AAEA;;;;;;;;;AAQO,SAAS,cAAc,EAC5B,OAAO,EACP,iBAAiB,EACjB,YAAY,EACN;;IACN,MAAM,EAAE,aAAa,EAAE,aAAa,EAAE,GAAG,CAAA,GAAA,2HAAA,CAAA,kBAAe,AAAD;IACvD,MAAM,EAAE,IAAI,EAAE,GAAG,CAAA,GAAA,wHAAA,CAAA,eAAY,AAAD;IAC5B,qBACE,6LAAC,wIAAA,CAAA,eAAY;QACX,cAAc,CAAC;YACb,kBAAkB;YAClB,IAAI,CAAC,MAAM;gBACT,aAAa;YACf;QACF;;0BAEA,6LAAC,wIAAA,CAAA,sBAAmB;gBAAC,OAAO;0BAC1B,cAAA,6LAAC,8HAAA,CAAA,SAAM;oBACL,SAAQ;oBACR,MAAK;oBACL,WAAU;8BAEV,cAAA,6LAAC;wBAAI,WAAU;wBAAS,MAAK;wBAAe,SAAQ;;0CAClD,6LAAC;gCAAO,IAAG;gCAAK,IAAG;gCAAK,GAAE;;;;;;0CAC1B,6LAAC;gCAAO,IAAG;gCAAI,IAAG;gCAAK,GAAE;;;;;;0CACzB,6LAAC;gCAAO,IAAG;gCAAK,IAAG;gCAAK,GAAE;;;;;;;;;;;;;;;;;;;;;;0BAIhC,6LAAC,wIAAA,CAAA,sBAAmB;gBAAC,WAAU;;oBAC5B,QAAQ,MAAM,CAAC,GAAG,KAAK,MAAM,oBAC5B;;0CACE,6LAAC,wIAAA,CAAA,mBAAgB;0CACf,cAAA,6LAAC;oCACC,WAAU;oCACV,SAAS,IAAM,cAAc;;sDAE7B,6LAAC,iOAAA,CAAA,iBAAc;4CAAC,WAAU;;;;;;sDAC1B,6LAAC;sDAAK;;;;;;;;;;;;;;;;;0CAGV,6LAAC,iIAAA,CAAA,YAAS;;;;;;;kCAGd,6LAAC,wIAAA,CAAA,mBAAgB;kCACf,cAAA,6LAAC;4BACC,WAAU;4BACV,SAAS,IAAM,cAAc;;8CAE7B,6LAAC,6MAAA,CAAA,SAAM;oCAAC,WAAU;;;;;;8CAClB,6LAAC;8CAAK;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAMlB;GAxDgB;;QAK2B,2HAAA,CAAA,kBAAe;QACvC,wHAAA,CAAA,eAAY;;;KANf","debugId":null}},
    {"offset": {"line": 1155, "column": 0}, "map": {"version":3,"sources":["file://D%3A/cnm_ws/cnm_project_24_25/g5-chatapp-fe/components/common/dialog/FileViewer.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { Button } from \"@/components/ui/button\";\r\nimport {\r\n  Dialog,\r\n  DialogClose,\r\n  DialogContent,\r\n  DialogFooter,\r\n  DialogTitle,\r\n  DialogTrigger,\r\n} from \"@/components/ui/dialog\";\r\nimport { useConversationStore } from \"@/store/useConversationStore\";\r\nimport { useMessageStore } from \"@/store/useMessageStore\";\r\nimport { Eye } from \"lucide-react\";\r\nimport mammoth from \"mammoth\";\r\nimport { useEffect, useState } from \"react\";\r\n\r\ninterface FileViewerDialogProps {\r\n  fileUrl: string | null;\r\n  fileName: string | null;\r\n}\r\n\r\nexport function FileViewerDialog({\r\n  fileUrl, // URL của file\r\n  fileName, // Tên file\r\n}: FileViewerDialogProps) {\r\n  // const { fileView } = useMessageStore();\r\n  const [content, setContent] = useState(\"\");\r\n  const [isLoading, setIsLoading] = useState(false);\r\n\r\n  // Xác định loại file từ URL\r\n  const isPdf = fileUrl?.toLowerCase().endsWith(\".pdf\");\r\n  const isDocx = fileUrl?.toLowerCase().endsWith(\".docx\");\r\n\r\n  // Xử lý file DOCX bằng mammoth.js\r\n  useEffect(() => {\r\n    if (isDocx && fileUrl) {\r\n      setIsLoading(true);\r\n      async function loadDocx() {\r\n        try {\r\n          const response = await fetch(fileUrl || \"\");\r\n          if (!response.ok) throw new Error(\"Failed to fetch DOCX file\");\r\n          const arrayBuffer = await response.arrayBuffer();\r\n          const result = await mammoth.convertToHtml({ arrayBuffer });\r\n          setContent(result.value);\r\n        } finally {\r\n          setIsLoading(false);\r\n        }\r\n      }\r\n      loadDocx();\r\n    }\r\n  }, [isDocx, fileUrl]);\r\n\r\n  return (\r\n    <Dialog>\r\n      <DialogTrigger asChild>\r\n        <Button size=\"icon\" className=\"text-sm text-gray-600 hover:text-blue-600\"\r\n                      title=\"Xem trước\"\r\n                      variant=\"link\">\r\n          <Eye className=\"h-5 w-5\" />\r\n        </Button>\r\n      </DialogTrigger>\r\n      <DialogContent className=\"w-[80vw] max-w-none h-[100vh] p-0 overflow-hidden\">\r\n        {\" \"}\r\n        {/* Adjusted width */}\r\n        <div className=\"flex flex-col h-full\">\r\n          {/* Header */}\r\n          <div className=\"flex items-center justify-between px-4 py-3 border-b\">\r\n            <DialogTitle className=\"text-base font-semibold\">\r\n              File view\r\n            </DialogTitle>\r\n          </div>\r\n\r\n          {/* File Content */}\r\n          <div className=\"flex-1 overflow-auto p-4\">\r\n            {isLoading && <p>Loading...</p>}\r\n            {!fileUrl && !isLoading && <p>No file selected.</p>}\r\n            {isPdf && fileUrl && (\r\n              <iframe\r\n                src={fileUrl}\r\n                style={{ width: \"100%\", height: \"100%\", border: \"none\" }}\r\n                title=\"PDF Viewer\"\r\n              />\r\n            )}\r\n            {isDocx && !isLoading && content && (\r\n              <div\r\n                className=\"prose max-w-none overflow-auto h-full\"\r\n                dangerouslySetInnerHTML={{ __html: content }}\r\n                style={{ maxHeight: \"calc(100vh - 150px)\" }} // Adjust height for scroll\r\n              />\r\n            )}\r\n\r\n            {!isPdf && !isDocx && fileUrl && (\r\n              <p className=\"text-red-500\">Unsupported file format.</p>\r\n            )}\r\n          </div>\r\n\r\n          {/* Footer */}\r\n          <DialogFooter className=\"bg-gray-50 px-4 py-3 border-t flex justify-end gap-2\">\r\n            <DialogClose asChild>\r\n              <Button variant=\"ghost\">Cancel</Button>\r\n            </DialogClose>\r\n            <Button onClick={() => {}}>Save</Button>\r\n          </DialogFooter>\r\n        </div>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAEA;AACA;AAUA;AACA;AACA;;;AAfA;;;;;;AAsBO,SAAS,iBAAiB,EAC/B,OAAO,EACP,QAAQ,EACc;;IACtB,0CAA0C;IAC1C,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACvC,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAE3C,4BAA4B;IAC5B,MAAM,QAAQ,SAAS,cAAc,SAAS;IAC9C,MAAM,SAAS,SAAS,cAAc,SAAS;IAE/C,kCAAkC;IAClC,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;sCAAE;YACR,IAAI,UAAU,SAAS;gBACrB,aAAa;gBACb,eAAe;oBACb,IAAI;wBACF,MAAM,WAAW,MAAM,MAAM,WAAW;wBACxC,IAAI,CAAC,SAAS,EAAE,EAAE,MAAM,IAAI,MAAM;wBAClC,MAAM,cAAc,MAAM,SAAS,WAAW;wBAC9C,MAAM,SAAS,MAAM,0IAAA,CAAA,UAAO,CAAC,aAAa,CAAC;4BAAE;wBAAY;wBACzD,WAAW,OAAO,KAAK;oBACzB,SAAU;wBACR,aAAa;oBACf;gBACF;gBACA;YACF;QACF;qCAAG;QAAC;QAAQ;KAAQ;IAEpB,qBACE,6LAAC,8HAAA,CAAA,SAAM;;0BACL,6LAAC,8HAAA,CAAA,gBAAa;gBAAC,OAAO;0BACpB,cAAA,6LAAC,8HAAA,CAAA,SAAM;oBAAC,MAAK;oBAAO,WAAU;oBAChB,OAAM;oBACN,SAAQ;8BACpB,cAAA,6LAAC,mMAAA,CAAA,MAAG;wBAAC,WAAU;;;;;;;;;;;;;;;;0BAGnB,6LAAC,8HAAA,CAAA,gBAAa;gBAAC,WAAU;;oBACtB;kCAED,6LAAC;wBAAI,WAAU;;0CAEb,6LAAC;gCAAI,WAAU;0CACb,cAAA,6LAAC,8HAAA,CAAA,cAAW;oCAAC,WAAU;8CAA0B;;;;;;;;;;;0CAMnD,6LAAC;gCAAI,WAAU;;oCACZ,2BAAa,6LAAC;kDAAE;;;;;;oCAChB,CAAC,WAAW,CAAC,2BAAa,6LAAC;kDAAE;;;;;;oCAC7B,SAAS,yBACR,6LAAC;wCACC,KAAK;wCACL,OAAO;4CAAE,OAAO;4CAAQ,QAAQ;4CAAQ,QAAQ;wCAAO;wCACvD,OAAM;;;;;;oCAGT,UAAU,CAAC,aAAa,yBACvB,6LAAC;wCACC,WAAU;wCACV,yBAAyB;4CAAE,QAAQ;wCAAQ;wCAC3C,OAAO;4CAAE,WAAW;wCAAsB;;;;;;oCAI7C,CAAC,SAAS,CAAC,UAAU,yBACpB,6LAAC;wCAAE,WAAU;kDAAe;;;;;;;;;;;;0CAKhC,6LAAC,8HAAA,CAAA,eAAY;gCAAC,WAAU;;kDACtB,6LAAC,8HAAA,CAAA,cAAW;wCAAC,OAAO;kDAClB,cAAA,6LAAC,8HAAA,CAAA,SAAM;4CAAC,SAAQ;sDAAQ;;;;;;;;;;;kDAE1B,6LAAC,8HAAA,CAAA,SAAM;wCAAC,SAAS,KAAO;kDAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAMvC;GAtFgB;KAAA","debugId":null}},
    {"offset": {"line": 1374, "column": 0}, "map": {"version":3,"sources":["file://D%3A/cnm_ws/cnm_project_24_25/g5-chatapp-fe/app/%28root%29/conversations/%5BconversationId%5D/_components/body/Message.tsx"],"sourcesContent":["import ForwardMessageDialog from \"@/components/common/dialog/ForwardMessageDialog\";\r\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { cn, getInitials } from \"@/lib/utils\";\r\nimport { useAuthStore } from \"@/store/useAuthStore\";\r\nimport { useMessageStore } from \"@/store/useMessageStore\";\r\nimport type { Message, MessageFile } from \"@/types\";\r\nimport axios from \"axios\";\r\nimport {\r\n  CheckCheck,\r\n  Download,\r\n  File,\r\n  FileArchive,\r\n  FileAudio,\r\n  FileCode,\r\n  FileImage,\r\n  FileSpreadsheet,\r\n  FileText,\r\n  FileVideo,\r\n  Forward,\r\n  Heart,\r\n  MessageSquareText,\r\n  Repeat,\r\n} from \"lucide-react\";\r\nimport { use, useEffect, useState } from \"react\";\r\nimport { toast } from \"sonner\";\r\nimport ImageGallery from \"./ImageGallery\";\r\nimport { MessageOption } from \"./MessageOption\";\r\nimport { FileViewerDialog } from \"@/components/common/dialog/FileViewer\";\r\n\r\ntype Props = {\r\n  message: Message | null;\r\n  fromCurrentUser: boolean;\r\n  senderImage: string;\r\n  file?: MessageFile[];\r\n  senderName: string;\r\n  lastByUser: boolean;\r\n  content: string;\r\n  createdAt: string;\r\n  type: string;\r\n  isTemp?: boolean;\r\n  isError?: boolean;\r\n  isLastMessage?: boolean;\r\n};\r\n\r\nconst Message = ({\r\n  fromCurrentUser,\r\n  senderImage,\r\n  file,\r\n  senderName,\r\n  lastByUser,\r\n  content,\r\n  createdAt,\r\n  type,\r\n  isTemp,\r\n  isError,\r\n  message,\r\n  isLastMessage,\r\n}: Props) => {\r\n  const formatTime = (timeStamp: number) => {\r\n    const date = new Date(timeStamp);\r\n    return date.toLocaleTimeString([], { hour: \"2-digit\", minute: \"2-digit\" });\r\n  };\r\n\r\n\r\n  const getFileIcon = (fileName: string) => {\r\n    const ext = fileName.split(\".\").pop()?.toLowerCase();\r\n\r\n    switch (ext) {\r\n      case \"pdf\":\r\n        return <FileText className=\"size-10 text-red-500\" />;\r\n      case \"doc\":\r\n      case \"docx\":\r\n        return <FileText className=\"size-10 text-blue-500\" />;\r\n      case \"xls\":\r\n      case \"xlsx\":\r\n        return <FileSpreadsheet className=\"size-10 text-green-500\" />;\r\n      case \"zip\":\r\n      case \"rar\":\r\n        return <FileArchive className=\"size-10 text-yellow-500\" />;\r\n      case \"mp3\":\r\n      case \"wav\":\r\n        return <FileAudio className=\"size-10 text-indigo-500\" />;\r\n      case \"mp4\":\r\n      case \"mov\":\r\n        return <FileVideo className=\"size-10 text-purple-500\" />;\r\n      case \"jpg\":\r\n      case \"jpeg\":\r\n      case \"png\":\r\n      case \"gif\":\r\n        return <FileImage className=\"size-10 text-pink-500\" />;\r\n      case \"js\":\r\n      case \"ts\":\r\n      case \"json\":\r\n      case \"html\":\r\n      case \"css\":\r\n        return <FileCode className=\"size-10 text-cyan-500\" />;\r\n      default:\r\n        return <File className=\"size-10 text-muted-foreground\" />;\r\n    }\r\n  };\r\n\r\n  const [imageSizes, setImageSizes] = useState<\r\n    { width: number; height: number }[]\r\n  >([]);\r\n\r\n  useEffect(() => {\r\n    if (type === \"IMAGE\" && file) {\r\n      const promises = file.map(\r\n        (img) =>\r\n          new Promise<{ width: number; height: number }>((resolve) => {\r\n            const i = new window.Image();\r\n            i.src = img.url;\r\n            i.onload = () => {\r\n              resolve({ width: i.naturalWidth, height: i.naturalHeight });\r\n            };\r\n          })\r\n      );\r\n\r\n      Promise.all(promises).then((sizes) => {\r\n        setImageSizes(sizes);\r\n      });\r\n    }\r\n  }, [file, type]);\r\n\r\n  const [isHovered, setIsHovered] = useState(false);\r\n\r\n  // check message is deleted\r\n  const { user } = useAuthStore();\r\n\r\n  const checkDeletedMessage = (message: Message | null) => {\r\n    if (!message) return false;\r\n    if (message.deletedFor && message.deletedFor.length > 0) {\r\n      return message.deletedFor.includes(user?._id);\r\n    }\r\n    return false;\r\n  };\r\n\r\n  const isLocationMessage = (message: Message | null) => {\r\n    if (!message) return false;\r\n    if (message.type === \"TEXT\") {\r\n      return (\r\n        message.content && /^-?\\d+\\.?\\d*,-?\\d+\\.?\\d*$/.test(message.content)\r\n      );\r\n    }\r\n    return false;\r\n  };\r\n\r\n  const getLocationFromMessage = (message: Message | null) => {\r\n    if (!message) return null;\r\n    if (message.type === \"TEXT\") {\r\n      const coords = message.content.split(\",\");\r\n      if (coords.length === 2) {\r\n        return {\r\n          latitude: parseFloat(coords[0]),\r\n          longitude: parseFloat(coords[1]),\r\n        };\r\n      }\r\n    }\r\n    return null;\r\n  };\r\n\r\n  const isDeleted = checkDeletedMessage(message);\r\n  // const [isHovered, setIsHovered] = useState(false);\r\n  const [isDropdownOpen, setIsDropdownOpen] = useState(false);\r\n\r\n  const handleMouseEnter = () => setIsHovered(true);\r\n  const handleMouseLeave = () => {\r\n    if (!isDropdownOpen) setIsHovered(false);\r\n  };\r\n\r\n  const { reactionMessage, unReactionMessage } = useMessageStore();\r\n\r\n  const checkReaction = (message: Message | null) => {\r\n    if (!message) return false;\r\n    if (message.reactions && message.reactions.length > 0) {\r\n      return message.reactions.some((reaction) => reaction.user === user?._id);\r\n    }\r\n    return false;\r\n  };\r\n\r\n  const groupReactions = (reactions: Message[\"reactions\"]) => {\r\n    const map = new Map<\r\n      string,\r\n      { count: number; reactedByCurrentUser: boolean }\r\n    >();\r\n\r\n    reactions?.forEach((reaction) => {\r\n      const existing = map.get(reaction.reaction);\r\n      if (existing) {\r\n        existing.count += 1;\r\n        if (reaction.user === user?._id) existing.reactedByCurrentUser = true;\r\n      } else {\r\n        map.set(reaction.reaction, {\r\n          count: 1,\r\n          reactedByCurrentUser: reaction.user === user?._id,\r\n        });\r\n      }\r\n    });\r\n\r\n    return Array.from(map.entries()).map(([reaction, data]) => ({\r\n      emoji: reaction,\r\n      count: data.count,\r\n      reactedByCurrentUser: data.reactedByCurrentUser,\r\n    }));\r\n  };\r\n\r\n  return (\r\n    <div\r\n      className={cn(\"flex items-end gap-2\", {\r\n        \"flex-row-reverse\": fromCurrentUser,\r\n      })}\r\n    >\r\n      <Avatar\r\n        className={cn(\"relative w-8 h-8 flex-shrink-0\", {\r\n          // \"order-2\": fromCurrentUser,\r\n          // \"order-1\": !fromCurrentUser,\r\n          invisible: lastByUser,\r\n        })}\r\n      >\r\n        <AvatarImage src={senderImage || \"/avatar.png\"} alt={senderName} />\r\n        <AvatarFallback>{getInitials(senderName)}</AvatarFallback>\r\n      </Avatar>\r\n      {/* chat content */}\r\n      <div\r\n        className=\"relative group\"\r\n        // onMouseEnter={() => setIsHovered(true)}\r\n        // onMouseLeave={() => setIsHovered(false)}\r\n        onMouseEnter={handleMouseEnter}\r\n        onMouseLeave={handleMouseLeave}\r\n      >\r\n        <div\r\n          className={cn(\"group\", {\r\n            // \"order-1 items-end\": fromCurrentUser,\r\n            // \"order-2 items-start\": !fromCurrentUser,\r\n          })}\r\n        >\r\n          {message && message.forwardFrom && (\r\n            <div\r\n              className={cn(\r\n                \"flex gap-2 z-10 text-foreground text-xs\",\r\n                fromCurrentUser ? \"-top-8 right-1\" : \"-top-8 left-1\"\r\n              )}\r\n            >\r\n              <Forward className=\"size-4\" /> Message is forwarded\r\n            </div>\r\n          )}\r\n\r\n          <div\r\n            className={cn(\"relative px-4 py-2 rounded-lg \", {\r\n              \"bg-secondary text-secondary-foreground\": fromCurrentUser,\r\n              \"bg-muted text-mute-foreground\": !fromCurrentUser,\r\n              \"rounded-br-none\": !lastByUser && fromCurrentUser,\r\n              \"rounded-bl-none\": !lastByUser && !fromCurrentUser,\r\n            })}\r\n          >\r\n            {!message?.isRevoked &&\r\n            type === \"TEXT\" &&\r\n            !isLocationMessage(message) ? (\r\n              <p className=\"text-wrap break-words whitespace-pre-wrap sm:max-w-[2200px] md:max-w-[550px] lg:max-w-[400px] xl:max-w-[600px]\">\r\n                {content}\r\n              </p>\r\n            ) : null}\r\n            {!message?.isRevoked && isLocationMessage(message) && (\r\n              <div className=\"flex flex-col gap-2\">\r\n                <iframe\r\n                  src={`https://maps.google.com/maps?q=${\r\n                    getLocationFromMessage(message)?.latitude\r\n                  },${\r\n                    getLocationFromMessage(message)?.longitude\r\n                  }&hl=es;z=14&output=embed`}\r\n                  width=\"100%\"\r\n                  height=\"100%\"\r\n                  style={{ border: 0 }}\r\n                  allowFullScreen\r\n                  loading=\"lazy\"\r\n                  referrerPolicy=\"no-referrer-when-downgrade\"\r\n                ></iframe>\r\n              </div>\r\n            )}\r\n            {!message?.isRevoked && type === \"STICKER\" && file && (\r\n              <img\r\n                src={file[0].url}\r\n                alt=\"sticker\"\r\n                className=\"rounded-lg max-w-[300px] max-h-[300px] object-contain\"\r\n              />\r\n            )}\r\n\r\n            {!message?.isRevoked && type === \"IMAGE\" && file && (\r\n              <ImageGallery\r\n                images={file}\r\n                sizes={imageSizes}\r\n                content={content}\r\n              />\r\n            )}\r\n            {!message?.isRevoked && type === \"AUDIO\" && file && (\r\n              <div className=\"flex flex-col gap-2\">\r\n                {file.map((audio, index) => (\r\n                  <div key={index} className=\"flex items-center gap-2\">\r\n                    <audio key={audio.url} controls>\r\n                      <source src={audio.url} type=\"audio/mp3\" />\r\n                      Your browser does not support the audio tag.\r\n                    </audio>\r\n                  </div>\r\n                ))}\r\n                {content && (\r\n                  <p className=\"text-wrap break-words whitespace-pre-wrap mt-2\">\r\n                    {content}\r\n                  </p>\r\n                )}\r\n              </div>\r\n            )}\r\n            {!message?.isRevoked && type === \"FILE\" && file && (\r\n              <div className=\"flex flex-col gap-2\">\r\n                {file.map((file, index) => (\r\n                  <div key={index} className=\"flex items-center\">\r\n                    {getFileIcon(file.fileName)}\r\n                    <span\r\n                      key={index}\r\n                      className=\"flex items-center gap-2 p-2 transition-all max-w-[440px] text-left\"\r\n                    >\r\n                      <span className=\"text-sm break-words line-clamp-2 text-foreground font-semibold\">\r\n                        {file.fileName}\r\n                      </span>\r\n                    </span>\r\n                    {/* sdsd */}\r\n                    <FileViewerDialog\r\n                      fileName={file?.fileName}\r\n                      fileUrl={file.url}\r\n                    />\r\n                    <Button\r\n                      onClick={async () => {\r\n                        try {\r\n                          const response = await axios.get(file.url, {\r\n                            responseType: \"blob\",\r\n                            headers: {},\r\n                          });\r\n\r\n                          if (response.status !== 200) {\r\n                            console.error(\"Failed to download file\");\r\n                            return;\r\n                          }\r\n\r\n                          const blob = response.data; // Đã là Blob rồi\r\n                          const url = window.URL.createObjectURL(blob);\r\n\r\n                          const link = document.createElement(\"a\");\r\n                          link.href = url;\r\n                          link.download = file.fileName;\r\n                          document.body.appendChild(link);\r\n                          link.click();\r\n                          link.remove();\r\n\r\n                          window.URL.revokeObjectURL(url);\r\n                        } catch (error) {\r\n                          console.error(\"Download error\", error);\r\n                          toast.error(\r\n                            \"Tải xuống không thành công. Vui lòng thử lại.\"\r\n                          );\r\n                        }\r\n                      }}\r\n                      className=\"text-sm text-gray-600 hover:text-blue-600\"\r\n                      title=\"Tải xuống\"\r\n                      variant=\"link\"\r\n                    >\r\n                      <Download className=\"size-10\" />\r\n                    </Button>\r\n                  </div>\r\n                ))}\r\n                {content && (\r\n                  <p className=\"text-wrap break-words whitespace-pre-wrap mt-2\">\r\n                    {content}\r\n                  </p>\r\n                )}\r\n              </div>\r\n            )}\r\n            {!message?.isRevoked && type === \"VIDEO\" && file && (\r\n              <div className=\"flex flex-col gap-2\">\r\n                {file.map((video, index) => (\r\n                  <div key={index} className=\"\">\r\n                    <video\r\n                      key={video.url}\r\n                      controls\r\n                      muted\r\n                      className=\"rounded-lg max-w-full max-h-96 object-contain bg-black\"\r\n                    >\r\n                      <source\r\n                        src={video.url}\r\n                        type={`video/${video.url.split(\".\").pop()}`}\r\n                      />\r\n                      Your browser does not support the video tag.\r\n                    </video>\r\n\r\n                    {/* Download button */}\r\n                    {/* <div className=\"bottom-2 right-2 transition-opacity\">\r\n                    <Button\r\n                      onClick={async () => {\r\n                        try {\r\n                          const response = await axios.get(video.url, {\r\n                            responseType: \"blob\",\r\n                          });\r\n\r\n                          const blob = response.data;\r\n                          const url = window.URL.createObjectURL(blob);\r\n\r\n                          const link = document.createElement(\"a\");\r\n                          link.href = url;\r\n                          link.download = video.fileName;\r\n                          document.body.appendChild(link);\r\n                          link.click();\r\n                          link.remove();\r\n\r\n                          window.URL.revokeObjectURL(url);\r\n                        } catch (error) {\r\n                          console.error(\"Download error\", error);\r\n                          toast.error(\r\n                            \"Download not successful. Please try again.\"\r\n                          );\r\n                        }\r\n                      }}\r\n                      variant=\"secondary\"\r\n                      size=\"icon\"\r\n                      className=\"rounded-full shadow-lg\"\r\n                    >\r\n                      <Download className=\"size-4\" />\r\n                    </Button>\r\n                  </div> */}\r\n                  </div>\r\n                ))}\r\n                {content && (\r\n                  <p className=\"text-wrap break-words whitespace-pre-wrap mt-2\">\r\n                    {content}\r\n                  </p>\r\n                )}\r\n              </div>\r\n            )}\r\n            {message && message?.isRevoked && (\r\n              <div className=\"flex gap-2 text-gray-600\">\r\n                Message is recalled\r\n              </div>\r\n            )}\r\n            <p\r\n              className={cn(\"text-xs flex w-full my-1\", {\r\n                \"text-secondary-foreground justify-end\": fromCurrentUser,\r\n                \"text-muted-foreground justify-start\": !fromCurrentUser,\r\n              })}\r\n            >\r\n              {formatTime(new Date(createdAt).getTime())}\r\n            </p>\r\n            {isLastMessage && (\r\n              <p className=\"absolute -bottom-4 right-1 text-muted-foreground flex w-full justify-end text-xs\">\r\n                <CheckCheck className=\"size-4\" /> received\r\n              </p>\r\n            )}\r\n          </div>\r\n          {isTemp && !isError && (\r\n            <p className=\"text-xs text-gray-500 italic\">Sending...</p>\r\n          )}\r\n          {isTemp && isError && (\r\n            <div className=\"flex items-center gap-2\">\r\n              <p className=\"text-xs text-red-500 italic\">Error</p>\r\n              <Button\r\n                onClick={() => toast.error(\"Đã xảy ra lỗi\")}\r\n                variant=\"ghost\"\r\n                size=\"icon\"\r\n                className=\"rounded-full shadow-lg\"\r\n              >\r\n                <Repeat className=\"size-2\" />\r\n              </Button>\r\n            </div>\r\n          )}\r\n        </div>\r\n        {message && message.reactions && message.reactions.length > 0 && (\r\n          //\r\n          <div\r\n            className={cn(\r\n              \"absolute -bottom-2 right-2 flex gap-1 z-20 bg-background rounded-full shadow-md p-1\",\r\n              {\r\n                \"right-auto left-2\": fromCurrentUser,\r\n                \"right-2\": !fromCurrentUser,\r\n              }\r\n            )}\r\n          >\r\n            {groupReactions(message.reactions).map((reaction) => (\r\n              <span\r\n                key={reaction.emoji}\r\n                className={cn(\r\n                  \"text-xs pl-1 cursor-pointer hover:opacity-70 rounded-full\",\r\n                  {\r\n                    \"bg-primary text-primary-foreground\":\r\n                      reaction.reactedByCurrentUser,\r\n                  }\r\n                )}\r\n                onClick={() => {\r\n                  if (reaction.reactedByCurrentUser) {\r\n                    unReactionMessage(message!._id);\r\n                  } else {\r\n                    // reactionMessage(message!._id, reaction.emoji);\r\n                  }\r\n                }}\r\n                title={`${reaction.count} người đã phản ứng`}\r\n              >\r\n                <span>{reaction.count > 1 && `${reaction.count}`}</span>\r\n                {\"\"}\r\n                {reaction.emoji}\r\n              </span>\r\n            ))}\r\n          </div>\r\n        )}\r\n\r\n        {isHovered && !checkReaction(message) && (\r\n          //&& message?.reactions?.length === 0\r\n          //\r\n          <div\r\n            className={cn(\r\n              \"absolute -bottom-2 right-2 flex gap-1 z-20 bg-background rounded-full shadow-md p-1\",\r\n              {\r\n                \"right-auto left-2\": !fromCurrentUser,\r\n                \"right-2\": fromCurrentUser,\r\n              }\r\n            )}\r\n          >\r\n            {[\"👍\", \"❤️\", \"😂\", \"😮\", \"😢\", \"😡\"].map((emoji) => (\r\n              <button\r\n                key={emoji}\r\n                onClick={() => reactionMessage(message!._id, emoji)}\r\n                className=\"text-lg hover:scale-110 transition-transform\"\r\n              >\r\n                {emoji}\r\n              </button>\r\n            ))}\r\n          </div>\r\n        )}\r\n\r\n        {isHovered && (\r\n          <div\r\n            className={cn(\r\n              \"absolute -right-[110px] bottom-6 flex gap-1 z-20 bg-background rounded-full shadow-md p-1\",\r\n              {\r\n                \"right-auto -left-[110px]\": fromCurrentUser, // Hiển thị bên trái nếu là user hiện tại\r\n              }\r\n            )}\r\n          >\r\n            <Button\r\n              variant=\"ghost\"\r\n              size=\"icon\"\r\n              className=\"rounded-full size-8 bg-background shadow-sm hover:bg-muted\"\r\n              onClick={(e) => {\r\n                e.stopPropagation();\r\n                // Handle reply logic\r\n              }}\r\n            >\r\n              <MessageSquareText className=\"size-4\" />\r\n            </Button>\r\n            <ForwardMessageDialog messageToForward={message} />\r\n            <MessageOption\r\n              message={message!}\r\n              setIsDropdownOpen={setIsDropdownOpen}\r\n              setIsHovered={setIsHovered}\r\n            />\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Message;\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2141, "column": 0}, "map": {"version":3,"sources":["file://D%3A/cnm_ws/cnm_project_24_25/g5-chatapp-fe/app/%28root%29/conversations/%5BconversationId%5D/_components/body/Body.tsx"],"sourcesContent":["import React, { useEffect } from \"react\";\r\nimport Message from \"./Message\";\r\nimport { useConversationStore } from \"@/store/useConversationStore\";\r\nimport { useAuthStore } from \"@/store/useAuthStore\";\r\nimport { sub } from \"date-fns\";\r\nimport { useMessageStore } from \"@/store/useMessageStore\";\r\n\r\ntype Props = {};\r\n\r\nconst Body = (props: Props) => {\r\n  const { selectedConversation } = useConversationStore();\r\n  const {\r\n    messages,\r\n    fetchMessages,\r\n    isTyping,\r\n  } = useMessageStore();\r\n  const { user } = useAuthStore();\r\n  useEffect(() => {\r\n    if (selectedConversation) {\r\n      fetchMessages(selectedConversation._id);\r\n    }\r\n  }, [selectedConversation, fetchMessages]);\r\n\r\n\r\n  const checkDeletedMessage = (message: Message | null) => {\r\n    if (!message) return false;\r\n    if (message.deletedFor && message.deletedFor.length > 0) {\r\n      return message.deletedFor.includes(user?._id);\r\n    }\r\n    return false;\r\n  };\r\n\r\n  const checkLastMessage = (message: Message | null) => {\r\n    if (!message || !messages || messages.length === 0) return false;\r\n    const lastMessage = messages[0];\r\n    return (\r\n      lastMessage._id === message._id &&\r\n      lastMessage.sender._id === user?._id &&\r\n      lastMessage._id !== \"temp\"\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className=\"h-[calc(100vh-14rem)] w-full flex flex-col\">\r\n      <div className=\"flex-1 w-full flex overflow-y-scroll flex-col-reverse gap-2 p-3 no-scrollbar\">\r\n        {messages &&\r\n          messages?.map((message, index) => {\r\n            const lastByUser =\r\n              messages[index - 1]?.sender._id === message.sender._id;\r\n            const isCurrentUser = message.sender._id === user?.id;\r\n            const isDeleted = checkDeletedMessage(message);\r\n            const isLastMessage = checkLastMessage(message);\r\n            if (isDeleted) return null; // Bỏ qua tin nhắn đã bị xóa\r\n            return (\r\n              <Message\r\n                key={index}\r\n                message={message}\r\n                fromCurrentUser={isCurrentUser}\r\n                senderImage={message.sender.avatar || \"\"}\r\n                file={message?.files || []}\r\n                senderName={message.sender.firstName || \"\"}\r\n                lastByUser={lastByUser}\r\n                content={message.content}\r\n                createdAt={message.createdAt}\r\n                type={message.type}\r\n                isTemp={message.isTemp || false}\r\n                isError={message.isError || false}\r\n                isLastMessage={isLastMessage}\r\n              />\r\n            );\r\n          })}\r\n      </div>\r\n      {isTyping && (\r\n        <div className=\"flex items-center gap-2 ml-12\">\r\n          <span className=\"text-gray-500\">Typing...</span>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Body;\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;AAEA;;;;;;;;AAIA,MAAM,OAAO,CAAC;;IACZ,MAAM,EAAE,oBAAoB,EAAE,GAAG,CAAA,GAAA,gIAAA,CAAA,uBAAoB,AAAD;IACpD,MAAM,EACJ,QAAQ,EACR,aAAa,EACb,QAAQ,EACT,GAAG,CAAA,GAAA,2HAAA,CAAA,kBAAe,AAAD;IAClB,MAAM,EAAE,IAAI,EAAE,GAAG,CAAA,GAAA,wHAAA,CAAA,eAAY,AAAD;IAC5B,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;0BAAE;YACR,IAAI,sBAAsB;gBACxB,cAAc,qBAAqB,GAAG;YACxC;QACF;yBAAG;QAAC;QAAsB;KAAc;IAGxC,MAAM,sBAAsB,CAAC;QAC3B,IAAI,CAAC,SAAS,OAAO;QACrB,IAAI,QAAQ,UAAU,IAAI,QAAQ,UAAU,CAAC,MAAM,GAAG,GAAG;YACvD,OAAO,QAAQ,UAAU,CAAC,QAAQ,CAAC,MAAM;QAC3C;QACA,OAAO;IACT;IAEA,MAAM,mBAAmB,CAAC;QACxB,IAAI,CAAC,WAAW,CAAC,YAAY,SAAS,MAAM,KAAK,GAAG,OAAO;QAC3D,MAAM,cAAc,QAAQ,CAAC,EAAE;QAC/B,OACE,YAAY,GAAG,KAAK,QAAQ,GAAG,IAC/B,YAAY,MAAM,CAAC,GAAG,KAAK,MAAM,OACjC,YAAY,GAAG,KAAK;IAExB;IAEA,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAI,WAAU;0BACZ,YACC,UAAU,IAAI,CAAC,SAAS;oBACtB,MAAM,aACJ,QAAQ,CAAC,QAAQ,EAAE,EAAE,OAAO,QAAQ,QAAQ,MAAM,CAAC,GAAG;oBACxD,MAAM,gBAAgB,QAAQ,MAAM,CAAC,GAAG,KAAK,MAAM;oBACnD,MAAM,YAAY,oBAAoB;oBACtC,MAAM,gBAAgB,iBAAiB;oBACvC,IAAI,WAAW,OAAO,MAAM,4BAA4B;oBACxD,qBACE,6LAAC,4LAAA,CAAA,UAAO;wBAEN,SAAS;wBACT,iBAAiB;wBACjB,aAAa,QAAQ,MAAM,CAAC,MAAM,IAAI;wBACtC,MAAM,SAAS,SAAS,EAAE;wBAC1B,YAAY,QAAQ,MAAM,CAAC,SAAS,IAAI;wBACxC,YAAY;wBACZ,SAAS,QAAQ,OAAO;wBACxB,WAAW,QAAQ,SAAS;wBAC5B,MAAM,QAAQ,IAAI;wBAClB,QAAQ,QAAQ,MAAM,IAAI;wBAC1B,SAAS,QAAQ,OAAO,IAAI;wBAC5B,eAAe;uBAZV;;;;;gBAeX;;;;;;YAEH,0BACC,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC;oBAAK,WAAU;8BAAgB;;;;;;;;;;;;;;;;;AAK1C;GAtEM;;QAC6B,gIAAA,CAAA,uBAAoB;QAKjD,2HAAA,CAAA,kBAAe;QACF,wHAAA,CAAA,eAAY;;;KAPzB;uCAwES","debugId":null}},
    {"offset": {"line": 2261, "column": 0}, "map": {"version":3,"sources":["file://D%3A/cnm_ws/cnm_project_24_25/g5-chatapp-fe/components/ui/form.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport * as React from \"react\"\r\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\r\nimport { Slot } from \"@radix-ui/react-slot\"\r\nimport {\r\n  Controller,\r\n  ControllerProps,\r\n  FieldPath,\r\n  FieldValues,\r\n  FormProvider,\r\n  useFormContext,\r\n} from \"react-hook-form\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\nimport { Label } from \"@/components/ui/label\"\r\n\r\nconst Form = FormProvider\r\n\r\ntype FormFieldContextValue<\r\n  TFieldValues extends FieldValues = FieldValues,\r\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\r\n> = {\r\n  name: TName\r\n}\r\n\r\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\r\n  {} as FormFieldContextValue\r\n)\r\n\r\nconst FormField = <\r\n  TFieldValues extends FieldValues = FieldValues,\r\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\r\n>({\r\n  ...props\r\n}: ControllerProps<TFieldValues, TName>) => {\r\n  return (\r\n    <FormFieldContext.Provider value={{ name: props.name }}>\r\n      <Controller {...props} />\r\n    </FormFieldContext.Provider>\r\n  )\r\n}\r\n\r\nconst useFormField = () => {\r\n  const fieldContext = React.useContext(FormFieldContext)\r\n  const itemContext = React.useContext(FormItemContext)\r\n  const { getFieldState, formState } = useFormContext()\r\n\r\n  const fieldState = getFieldState(fieldContext.name, formState)\r\n\r\n  if (!fieldContext) {\r\n    throw new Error(\"useFormField should be used within <FormField>\")\r\n  }\r\n\r\n  const { id } = itemContext\r\n\r\n  return {\r\n    id,\r\n    name: fieldContext.name,\r\n    formItemId: `${id}-form-item`,\r\n    formDescriptionId: `${id}-form-item-description`,\r\n    formMessageId: `${id}-form-item-message`,\r\n    ...fieldState,\r\n  }\r\n}\r\n\r\ntype FormItemContextValue = {\r\n  id: string\r\n}\r\n\r\nconst FormItemContext = React.createContext<FormItemContextValue>(\r\n  {} as FormItemContextValue\r\n)\r\n\r\nconst FormItem = React.forwardRef<\r\n  HTMLDivElement,\r\n  React.HTMLAttributes<HTMLDivElement>\r\n>(({ className, ...props }, ref) => {\r\n  const id = React.useId()\r\n\r\n  return (\r\n    <FormItemContext.Provider value={{ id }}>\r\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\r\n    </FormItemContext.Provider>\r\n  )\r\n})\r\nFormItem.displayName = \"FormItem\"\r\n\r\nconst FormLabel = React.forwardRef<\r\n  React.ElementRef<typeof LabelPrimitive.Root>,\r\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\r\n>(({ className, ...props }, ref) => {\r\n  const { error, formItemId } = useFormField()\r\n\r\n  return (\r\n    <Label\r\n      ref={ref}\r\n      className={cn(error && \"text-destructive\", className)}\r\n      htmlFor={formItemId}\r\n      {...props}\r\n    />\r\n  )\r\n})\r\nFormLabel.displayName = \"FormLabel\"\r\n\r\nconst FormControl = React.forwardRef<\r\n  React.ElementRef<typeof Slot>,\r\n  React.ComponentPropsWithoutRef<typeof Slot>\r\n>(({ ...props }, ref) => {\r\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\r\n\r\n  return (\r\n    <Slot\r\n      ref={ref}\r\n      id={formItemId}\r\n      aria-describedby={\r\n        !error\r\n          ? `${formDescriptionId}`\r\n          : `${formDescriptionId} ${formMessageId}`\r\n      }\r\n      aria-invalid={!!error}\r\n      {...props}\r\n    />\r\n  )\r\n})\r\nFormControl.displayName = \"FormControl\"\r\n\r\nconst FormDescription = React.forwardRef<\r\n  HTMLParagraphElement,\r\n  React.HTMLAttributes<HTMLParagraphElement>\r\n>(({ className, ...props }, ref) => {\r\n  const { formDescriptionId } = useFormField()\r\n\r\n  return (\r\n    <p\r\n      ref={ref}\r\n      id={formDescriptionId}\r\n      className={cn(\"text-sm text-muted-foreground\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n})\r\nFormDescription.displayName = \"FormDescription\"\r\n\r\nconst FormMessage = React.forwardRef<\r\n  HTMLParagraphElement,\r\n  React.HTMLAttributes<HTMLParagraphElement>\r\n>(({ className, children, ...props }, ref) => {\r\n  const { error, formMessageId } = useFormField()\r\n  const body = error ? String(error?.message) : children\r\n\r\n  if (!body) {\r\n    return null\r\n  }\r\n\r\n  return (\r\n    <p\r\n      ref={ref}\r\n      id={formMessageId}\r\n      className={cn(\"text-sm font-medium text-destructive\", className)}\r\n      {...props}\r\n    >\r\n      {body}\r\n    </p>\r\n  )\r\n})\r\nFormMessage.displayName = \"FormMessage\"\r\n\r\nexport {\r\n  useFormField,\r\n  Form,\r\n  FormItem,\r\n  FormLabel,\r\n  FormControl,\r\n  FormDescription,\r\n  FormMessage,\r\n  FormField,\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2479, "column": 0}, "map": {"version":3,"sources":["file://D%3A/cnm_ws/cnm_project_24_25/g5-chatapp-fe/app/%28root%29/conversations/%5BconversationId%5D/_components/input/ChatInput.tsx"],"sourcesContent":["\"use client\";\r\nimport { Card } from \"@/components/ui/card\";\r\nimport {\r\n  Form,\r\n  FormControl,\r\n  FormField,\r\n  FormItem,\r\n  FormMessage,\r\n} from \"@/components/ui/form\";\r\nimport { zodResolver } from \"@hookform/resolvers/zod\";\r\nimport {\r\n  CirclePlus,\r\n  // File,\r\n  FileArchive,\r\n  FileAudio,\r\n  FileUp,\r\n  FileVideo,\r\n  FormInput,\r\n  Image,\r\n  Mic,\r\n  SendHorizonal,\r\n  Smile,\r\n  ThumbsUp,\r\n  Video,\r\n  X,\r\n} from \"lucide-react\";\r\nimport React, { useEffect, useRef, useState } from \"react\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport { z } from \"zod\";\r\nimport TextareaAutosize from \"react-textarea-autosize\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport { useConversationStore } from \"@/store/useConversationStore\";\r\nimport EmojiPicker from \"emoji-picker-react\";\r\nimport { useAuthStore } from \"@/store/useAuthStore\";\r\nimport { toast } from \"sonner\";\r\nimport { useMessageStore } from \"@/store/useMessageStore\";\r\n\r\ntype Props = {};\r\n\r\nconst chatMessageSchema = z.object({\r\n  content: z.string(),\r\n  files: z\r\n    .array(z.instanceof(File))\r\n    .max(5) // Giới hạn số lượng file\r\n    .optional(),\r\n});\r\n\r\nconst ChatInput = (props: Props) => {\r\n  const form = useForm<z.infer<typeof chatMessageSchema>>({\r\n    resolver: zodResolver(chatMessageSchema),\r\n    defaultValues: {\r\n      content: \"\",\r\n    },\r\n  });\r\n\r\n  const [filePreviews, setFilePreviews] = useState<\r\n    { file: File; preview?: string }[]\r\n  >([]);\r\n\r\n  const fileInputRef = useRef<HTMLInputElement | null>(null);\r\n  const imageInputRef = useRef<HTMLInputElement | null>(null);\r\n  const videoInputRef = useRef<HTMLInputElement | null>(null);\r\n\r\n  // voice\r\n  const [isRecording, setIsRecording] = useState(false);\r\n  const [recordingUrl, setRecordingUrl] = useState<string | null>(null);\r\n  const [recordedFile, setRecordedFile] = useState<File | null>(null);\r\n  const [recordingTime, setRecordingTime] = useState(0);\r\n  const mediaRecorderRef = useRef<MediaRecorder | null>(null);\r\n  const recordingInterval = useRef<NodeJS.Timeout | null>(null);\r\n\r\n  const startRecording = async () => {\r\n    try {\r\n      const stream = await navigator.mediaDevices.getUserMedia({ audio: true });\r\n      const mediaRecorder = new MediaRecorder(stream);\r\n      const audioChunks: Blob[] = [];\r\n\r\n      mediaRecorder.ondataavailable = (event) => {\r\n        if (event.data.size > 0) {\r\n          audioChunks.push(event.data);\r\n        }\r\n      };\r\n\r\n      mediaRecorder.onstop = () => {\r\n        const blob = new Blob(audioChunks, { type: \"audio/webm\" });\r\n        const url = URL.createObjectURL(blob);\r\n        const file = new File([blob], `voice-${Date.now()}.webm`, {\r\n          type: \"audio/webm\",\r\n        });\r\n\r\n        setRecordingUrl(url);\r\n        setRecordedFile(file);\r\n      };\r\n\r\n      mediaRecorderRef.current = mediaRecorder;\r\n      mediaRecorder.start();\r\n      setIsRecording(true);\r\n      setRecordingTime(0);\r\n\r\n      // Đếm thời gian ghi\r\n      recordingInterval.current = setInterval(() => {\r\n        setRecordingTime((prev) => prev + 1);\r\n      }, 1000);\r\n    } catch (error) {\r\n      toast.error(\"Không thể truy cập microphone\");\r\n    }\r\n  };\r\n\r\n  const stopRecording = () => {\r\n    if (mediaRecorderRef.current) {\r\n      mediaRecorderRef.current.stop();\r\n      setIsRecording(false);\r\n\r\n      if (recordingInterval.current) {\r\n        clearInterval(recordingInterval.current);\r\n      }\r\n    }\r\n  };\r\n\r\n  const { user } = useAuthStore();\r\n  const { selectedConversation } = useConversationStore();\r\n  const { addTempMessage, sendMessage, typing } = useMessageStore();\r\n  const [showEmojiPicker, setShowEmojiPicker] = useState(false);\r\n\r\n  const generateMessageTemp = (type: string, url: string, fileName: string) => {\r\n    return {\r\n      _id: \"temp\",\r\n      sender: {\r\n        _id: user?.id || \"\",\r\n        firstName: user?.firstName || \"\",\r\n        lastName: user?.lastName || \"\",\r\n        avatar: user?.avatar || \"\",\r\n        id: user?.id || \"\",\r\n        email: user?.email || \"\",\r\n      },\r\n      conversation: selectedConversation?._id || \"\",\r\n      content: form.getValues(\"content\") || \"\",\r\n      createdAt: new Date().toISOString(),\r\n      type: type,\r\n      files: [\r\n        {\r\n          fileName: fileName || \"\",\r\n          url: url || \"\",\r\n        },\r\n      ],\r\n      isTemp: true,\r\n      deletedFor: [],\r\n      isRevoked: false,\r\n      forwardFrom: null,\r\n      updatedAt: new Date().toISOString(),\r\n    };\r\n  };\r\n\r\n  const handleSubmit = (data: z.infer<typeof chatMessageSchema>) => {\r\n    const files = data.files || []; // Lấy files từ form\r\n    const hasText = data.content.trim() !== \"\";\r\n    const hasFiles = files.length > 0;\r\n    const hasVoice = recordedFile !== null;\r\n\r\n    if (!hasText && !hasFiles && !hasVoice) return;\r\n\r\n    const mediaFiles = files.filter(\r\n      (file) => file.type.startsWith(\"image/\") || file.type.startsWith(\"video/\")\r\n    );\r\n    const otherFiles = files.filter(\r\n      (file) =>\r\n        !file.type.startsWith(\"image/\") && !file.type.startsWith(\"video/\")\r\n    );\r\n\r\n    // Nếu có voice message\r\n    if (recordedFile) {\r\n      const tempVoice = generateMessageTemp(\r\n        \"AUDIO\",\r\n        recordingUrl || \"\",\r\n        recordedFile.name\r\n      );\r\n      sendMessage({ content: \"\", files: [recordedFile] });\r\n      addTempMessage(tempVoice);\r\n      setRecordingUrl(null);\r\n      setRecordedFile(null);\r\n      setRecordingTime(0);\r\n      return;\r\n    }\r\n\r\n    if (hasText || mediaFiles.length > 0 || otherFiles.length <= 1) {\r\n      sendMessage({ ...data, files });\r\n\r\n      let preview = \"\";\r\n      let fileName = \"\";\r\n\r\n      if (mediaFiles.length > 0) {\r\n        const firstMedia = mediaFiles[0];\r\n        const previewInfo = filePreviews.find((fp) => fp.file === firstMedia);\r\n        preview = previewInfo?.preview || \"\";\r\n        fileName = firstMedia.name || \"\";\r\n      }\r\n\r\n      const tempMessage = generateMessageTemp(\r\n        mediaFiles.length > 0 ? \"IMAGE\" : \"TEXT\",\r\n        preview,\r\n        fileName\r\n      );\r\n\r\n      addTempMessage(tempMessage);\r\n      console.log(\"Sent message:\", tempMessage);\r\n    } else {\r\n      otherFiles.forEach((file, index) => {\r\n        sendMessage({ content: \"\", files: [file] });\r\n        const tempMessage = generateMessageTemp(\r\n          \"FILE\",\r\n          filePreviews[index].preview || \"\",\r\n          file.name\r\n        );\r\n        addTempMessage(tempMessage);\r\n      });\r\n    }\r\n\r\n    form.reset({ content: \"\", files: [] });\r\n    setFilePreviews([]);\r\n  };\r\n\r\n  const handleInputChange = (event: any) => {\r\n    const { value, selectionStart } = event.target;\r\n    if (selectionStart !== null) {\r\n      form.setValue(\"content\", value);\r\n      typing(selectedConversation?._id || \"\");\r\n    }\r\n  };\r\n\r\n  const readFilePreview = (file: File): Promise<string | undefined> => {\r\n    return new Promise((resolve) => {\r\n      if (!file.type.startsWith(\"image/\")) return resolve(undefined);\r\n      const reader = new FileReader();\r\n      reader.onloadend = () => {\r\n        resolve(reader.result as string);\r\n      };\r\n      reader.readAsDataURL(file);\r\n      typing(selectedConversation?._id || \"\");\r\n    });\r\n  };\r\n\r\n  const addFilesWithPreview = async (files: File[]) => {\r\n    const newPreviews = await Promise.all(\r\n      files.map(async (file) => ({\r\n        file,\r\n        preview: file.type.startsWith(\"image/\")\r\n          ? await readFilePreview(file)\r\n          : file.type.startsWith(\"video/\")\r\n          ? URL.createObjectURL(file)\r\n          : undefined,\r\n      }))\r\n    );\r\n\r\n    setFilePreviews((prev) => [...prev, ...newPreviews]);\r\n  };\r\n\r\n  const handleImageChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const files = e.target.files;\r\n    if (files) {\r\n      addFilesWithPreview(Array.from(files)).then(() =>\r\n        typing(selectedConversation?._id || \"\")\r\n      );\r\n    }\r\n  };\r\n\r\n  const handlePaste = async (e: React.ClipboardEvent<HTMLTextAreaElement>) => {\r\n    e.preventDefault();\r\n\r\n    const items = e.clipboardData.items;\r\n    const files: File[] = [];\r\n    let pasteText = \"\";\r\n\r\n    for (const item of items) {\r\n      // Xử lý ảnh từ Snip & Sketch\r\n      if (item.kind === \"file\" && item.type.startsWith(\"image/\")) {\r\n        const blob = item.getAsFile();\r\n        if (blob) {\r\n          // Tạo file với tên và type chính xác\r\n          const file = new File([blob], `screenshot-${Date.now()}.png`, {\r\n            type: \"image/png\",\r\n          });\r\n          files.push(file);\r\n        }\r\n      }\r\n      // Xử lý trường hợp copy từ ứng dụng khác\r\n      else if (item.kind === \"string\" && item.type === \"text/html\") {\r\n        const html = await new Promise<string>((resolve) =>\r\n          item.getAsString(resolve)\r\n        );\r\n        const imgSrc = html.match(/<img[^>]+src=\"([^\">]+)\"/)?.[1];\r\n        if (imgSrc?.startsWith(\"data:image\")) {\r\n          const file = dataURLtoFile(imgSrc, `screenshot-${Date.now()}.png`);\r\n          files.push(file);\r\n        }\r\n      } else if (item.kind === \"string\" && item.type === \"text/plain\") {\r\n        pasteText = await new Promise<string>((resolve) =>\r\n          item.getAsString(resolve)\r\n        );\r\n      }\r\n    }\r\n\r\n    if (files.length > 0) {\r\n      await addFilesWithPreview(files);\r\n    }\r\n    if (pasteText) {\r\n      form.setValue(\"content\", pasteText);\r\n    }\r\n  };\r\n\r\n  // Hàm chuyển data URL thành File\r\n  const dataURLtoFile = (dataurl: string, filename: string) => {\r\n    const arr = dataurl.split(\",\");\r\n    const mime = arr[0].match(/:(.*?);/)![1];\r\n    const bstr = atob(arr[1]);\r\n    let n = bstr.length;\r\n    const u8arr = new Uint8Array(n);\r\n\r\n    while (n--) {\r\n      u8arr[n] = bstr.charCodeAt(n);\r\n    }\r\n\r\n    return new File([u8arr], filename, { type: mime });\r\n  };\r\n\r\n  useEffect(() => {\r\n    form.setValue(\r\n      \"files\",\r\n      filePreviews.map((fp) => fp.file)\r\n    );\r\n  }, [filePreviews, form]);\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      // Dọn dẹp object URLs\r\n      filePreviews.forEach((preview) => {\r\n        if (preview.preview) {\r\n          URL.revokeObjectURL(preview.preview);\r\n        }\r\n      });\r\n    };\r\n  }, [filePreviews]);\r\n\r\n  const handleFileChange = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    const files = event.target.files;\r\n    if (files) {\r\n      const newFiles = Array.from(files);\r\n      setFilePreviews((prev) => [\r\n        ...prev,\r\n        ...newFiles.map((file) => ({ file, preview: undefined })),\r\n      ]);\r\n    }\r\n  };\r\n\r\n  const handleVideoChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const files = e.target.files;\r\n    if (files) {\r\n      addFilesWithPreview(Array.from(files)).then(() =>\r\n        typing(selectedConversation?._id || \"\")\r\n      );\r\n    }\r\n  };\r\n\r\n  const watchedContent = form.watch(\"content\");\r\n  const watchedFiles = form.watch(\"files\");\r\n  const hasText = watchedContent?.trim().length > 0;\r\n  const hasFiles = watchedFiles && watchedFiles.length > 0;\r\n\r\n  const handleLike = () => {\r\n    // Xử lý sự kiện khi nhấn nút \"Like\"\r\n    sendMessage({\r\n      content: \"👍\",\r\n    });\r\n    console.log(\"Liked!\");\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (recordingTime >= 60 && isRecording) {\r\n      stopRecording();\r\n      toast.info(\"Recording stopped automatically after 60 seconds.\");\r\n    }\r\n  }, [recordingTime, isRecording]);\r\n\r\n  const [isOpenOptions, setIsOpenOptions] = React.useState(false);\r\n  return (\r\n    <Card className=\"w-full p-2 rounded-lg relative flex flex-col gap-2\">\r\n      <div\r\n        className={cn(\r\n          \"flex justify-between border-b pb-1\",\r\n          isOpenOptions ? \"\" : \"hidden\"\r\n        )}\r\n      >\r\n        <div className=\"flex gap-2\">\r\n          <Button\r\n            disabled={false}\r\n            size={\"icon\"}\r\n            type=\"button\"\r\n            onClick={() => {\r\n              if (fileInputRef.current) {\r\n                fileInputRef.current.click();\r\n              }\r\n            }}\r\n          >\r\n            <FileUp />\r\n          </Button>\r\n          <Button\r\n            disabled={false}\r\n            size={\"icon\"}\r\n            type=\"button\"\r\n            onClick={() => {\r\n              if (imageInputRef.current) {\r\n                imageInputRef.current.click();\r\n              }\r\n            }}\r\n          >\r\n            <Image />\r\n          </Button>\r\n          <Button\r\n            disabled={false}\r\n            size={\"icon\"}\r\n            type=\"button\"\r\n            onClick={() => {\r\n              if (videoInputRef.current) {\r\n                videoInputRef.current.click();\r\n              }\r\n            }}\r\n          >\r\n            <FileVideo />\r\n          </Button>\r\n        </div>\r\n        <div>\r\n          <Button\r\n            disabled={false}\r\n            size={\"icon\"}\r\n            type=\"button\"\r\n            variant={\"outline\"}\r\n            onClick={() => setIsOpenOptions(false)}\r\n          >\r\n            <X />\r\n          </Button>\r\n        </div>\r\n      </div>\r\n      <div className=\"flex flex-col gap-2 items-end w-full\">\r\n        <Form {...form}>\r\n          <form\r\n            onSubmit={form.handleSubmit(handleSubmit)}\r\n            className=\"flex gap-2 items-end w-full\"\r\n          >\r\n            {/* tạo dialog cho chọn option như file, hình ảnh */}\r\n            <Button\r\n              disabled={isOpenOptions}\r\n              size={\"icon\"}\r\n              type=\"button\"\r\n              onClick={() => setIsOpenOptions(!isOpenOptions)}\r\n              className={cn(\"\", isOpenOptions ? \"hidden\" : \"\")}\r\n            >\r\n              <CirclePlus />\r\n            </Button>\r\n            <input\r\n              type=\"file\"\r\n              ref={imageInputRef}\r\n              accept=\"image/*\"\r\n              className=\"hidden\"\r\n              onChange={handleImageChange}\r\n              multiple\r\n            />\r\n            <input\r\n              type=\"file\"\r\n              ref={fileInputRef}\r\n              accept=\".pdf,.doc,.docx,.txt,.xlsx,.xls\"\r\n              className=\"hidden\"\r\n              onChange={handleFileChange}\r\n              multiple\r\n            />\r\n            <input\r\n              type=\"file\"\r\n              ref={videoInputRef}\r\n              accept=\"video/*\"\r\n              className=\"hidden\"\r\n              onChange={handleVideoChange}\r\n              multiple\r\n            />\r\n            <FormField\r\n              control={form.control}\r\n              name=\"content\"\r\n              render={({ field }) => {\r\n                return (\r\n                  <FormItem className=\"w-full\">\r\n                    <FormControl>\r\n                      <TextareaAutosize\r\n                        onKeyDown={async (e) => {\r\n                          if (e.key === \"Enter\" && !e.shiftKey) {\r\n                            e.preventDefault();\r\n                            await form.handleSubmit(handleSubmit)();\r\n                          }\r\n                        }}\r\n                        onPaste={(e) => handlePaste(e)}\r\n                        rows={1}\r\n                        maxRows={3}\r\n                        {...field}\r\n                        onChange={handleInputChange}\r\n                        onClick={handleInputChange}\r\n                        placeholder=\"Type a message...\"\r\n                        className=\"min-h-[36px] w-full resize-none border-0 outline-0 placeholder:text-muted-foreground p-1.5\"\r\n                      />\r\n                    </FormControl>\r\n                    <FormMessage />\r\n                  </FormItem>\r\n                );\r\n              }}\r\n            />\r\n            <Button\r\n              type=\"button\"\r\n              variant={\"ghost\"}\r\n              size={\"icon\"}\r\n              onClick={() => setShowEmojiPicker(!showEmojiPicker)}\r\n            >\r\n              <Smile className=\"size-4\" />\r\n            </Button>\r\n\r\n            {hasText || hasFiles || recordedFile ? (\r\n              <Button disabled={false} size={\"icon\"} type=\"submit\">\r\n                <SendHorizonal />\r\n              </Button>\r\n            ) : (\r\n              <>\r\n                <Button\r\n                  type=\"button\"\r\n                  size={\"icon\"}\r\n                  variant={\"ghost\"}\r\n                  onClick={() =>\r\n                    isRecording ? stopRecording() : startRecording()\r\n                  }\r\n                >\r\n                  <Mic\r\n                    className={cn(\"size-4\", isRecording && \"text-red-500\")}\r\n                  />\r\n                </Button>\r\n                <Button\r\n                  type=\"button\"\r\n                  size={\"icon\"}\r\n                  variant={\"ghost\"}\r\n                  onClick={() => handleLike()}\r\n                >\r\n                  <ThumbsUp className=\"size-4\" />\r\n                </Button>\r\n              </>\r\n            )}\r\n          </form>\r\n        </Form>\r\n        {showEmojiPicker && (\r\n          <div className=\"absolute bottom-full mb-2 right-0 z-50\">\r\n            <EmojiPicker\r\n              onEmojiClick={(emojiData) => {\r\n                const current = form.getValues(\"content\");\r\n                form.setValue(\"content\", current + emojiData.emoji);\r\n                setShowEmojiPicker(false);\r\n              }}\r\n            />\r\n          </div>\r\n        )}\r\n\r\n        {filePreviews.length > 0 && (\r\n          <div className=\"flex flex-wrap gap-2 w-full absolute -top-24 left-0 p-2 bg-white rounded-lg shadow-lg \">\r\n            {filePreviews.map((file, index) => {\r\n              const isImage = file.file.type.startsWith(\"image/\");\r\n              const isVideo = file.file.type.startsWith(\"video/\");\r\n              const fileName = file.file.name;\r\n              const fileSizeKB = (file.file.size / 1024).toFixed(1); // KB\r\n              const fileExtension = file.file.name\r\n                .split(\".\")\r\n                .pop()\r\n                ?.toUpperCase();\r\n\r\n              return (\r\n                <div key={index} className=\"relative\">\r\n                  {isImage ? (\r\n                    <img\r\n                      src={file.preview}\r\n                      alt={`preview-${index}`}\r\n                      className=\"size-20 object-cover rounded-lg border\"\r\n                    />\r\n                  ) : isVideo ? (\r\n                    <video\r\n                      src={file.preview}\r\n                      className=\"size-20 object-cover rounded-lg border\"\r\n                      controls={false}\r\n                      muted\r\n                    >\r\n                      <track kind=\"captions\" />\r\n                    </video>\r\n                  ) : (\r\n                    <div\r\n                      title={fileName}\r\n                      className=\"w-36 p-2 border rounded-lg bg-muted text-sm text-left flex flex-col gap-1 justify-between overflow-hidden\"\r\n                    >\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <FileUp className=\"w-6 h-6 text-primary shrink-0\" />\r\n                        <span className=\"text-xs font-medium truncate w-full\">\r\n                          {fileName}\r\n                        </span>\r\n                      </div>\r\n                      <div className=\"flex justify-between text-xs text-muted-foreground\">\r\n                        <span>{fileExtension}</span>\r\n                        <span>{fileSizeKB} KB</span>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n\r\n                  <button\r\n                    type=\"button\"\r\n                    className=\"absolute -top-1.5 -right-1.5 size-5 bg-white rounded-full flex items-center justify-center text-red-500 shadow\"\r\n                    onClick={() => {\r\n                      setFilePreviews((prev) =>\r\n                        prev.filter((_, i) => i !== index)\r\n                      );\r\n                    }}\r\n                  >\r\n                    <X className=\"size-4\" />\r\n                  </button>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        )}\r\n        {recordingUrl && (\r\n          <div className=\"flex flex-wrap gap-2 w-full absolute -top-24 left-0 p-2 bg-white rounded-lg shadow-lg \">\r\n            <audio controls src={recordingUrl} className=\"w-full\" />\r\n            <Button\r\n              size={\"icon\"}\r\n              variant={\"destructive\"}\r\n              className=\"absolute -top-1.5 -right-1.5 size-5 bg-white rounded-full flex items-center justify-center text-red-500 shadow\"\r\n              onClick={() => {\r\n                setRecordingUrl(null);\r\n                setRecordedFile(null);\r\n                setRecordingTime(0);\r\n              }}\r\n            >\r\n              <X className=\"size-4\" />\r\n            </Button>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default ChatInput;\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3345, "column": 0}, "map": {"version":3,"sources":["file://D%3A/cnm_ws/cnm_project_24_25/g5-chatapp-fe/components/common/conversation/ConversationContainer.tsx"],"sourcesContent":["import { Card } from \"@/components/ui/card\";\r\nimport React from \"react\";\r\n\r\ntype Props = React.PropsWithChildren<{}>;\r\n\r\nconst ConversationContainer = ({ children }: Props) => {\r\n  return (\r\n    <Card className=\"w-full h-[calc(100vh - 32px)] lg:h-full p-2 grid grid-cols-9 gap-2\">\r\n      {children}\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default ConversationContainer;\r\n"],"names":[],"mappings":";;;;AAAA;;;AAKA,MAAM,wBAAwB,CAAC,EAAE,QAAQ,EAAS;IAChD,qBACE,6LAAC,4HAAA,CAAA,OAAI;QAAC,WAAU;kBACb;;;;;;AAGP;KANM;uCAQS","debugId":null}},
    {"offset": {"line": 3375, "column": 0}, "map": {"version":3,"sources":["file://D%3A/cnm_ws/cnm_project_24_25/g5-chatapp-fe/app/%28root%29/conversations/%5BconversationId%5D/_components/info/ShowGroupMember.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { Avatar, AvatarImage } from \"@/components/ui/avatar\";\r\nimport { useAuthStore } from \"@/store/useAuthStore\";\r\nimport { Member } from \"@/types\";\r\nimport React, { useState } from \"react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport {\r\n  Popover,\r\n  PopoverContent,\r\n  PopoverTrigger,\r\n} from \"@/components/ui/popover\";\r\nimport {\r\n  ArrowDown,\r\n  ArrowUp,\r\n  ChevronDown,\r\n  ChevronUp,\r\n  MoreVertical,\r\n} from \"lucide-react\";\r\nimport { useConversationStore } from \"@/store/useConversationStore\";\r\n\r\ntype Props = {\r\n  members: Member[];\r\n  isActive: boolean;\r\n  setIsActive: (isActive: boolean) => void;\r\n};\r\n\r\nconst ShowGroupMember = ({ members, isActive, setIsActive }: Props) => {\r\n  const { user } = useAuthStore();\r\n  const {\r\n    removeMemberFromGroup,\r\n    selectedConversation,\r\n    changeRoleMember,\r\n    changeAdminGroup,\r\n  } = useConversationStore();\r\n  const [hoveredMemberId, setHoveredMemberId] = useState<string | null>(null);\r\n\r\n  const currentMember = members.find((m) => m.user._id === user?.id);\r\n  const isCurrentUserAdmin = currentMember?.role === \"ADMIN\";\r\n\r\n  const sortMembers = members.sort((a, b) => {\r\n    if (a.role === \"ADMIN\" && b.role !== \"ADMIN\") return -1;\r\n    if (b.role === \"ADMIN\" && a.role !== \"ADMIN\") return 1;\r\n    return 0;\r\n  });\r\n\r\n  const handleRemove = async (member: Member) => {\r\n    console.log(\"Remove:\", member.user.firstName);\r\n    await removeMemberFromGroup(selectedConversation?._id!, member.user._id!);\r\n  };\r\n\r\n  const handleMakeAdmin = async (member: Member) => {\r\n    console.log(\"Make admin:\", member.user.firstName);\r\n    await changeAdminGroup(selectedConversation?._id!, member.user._id!);\r\n  };\r\n\r\n  const handleMakeOwner = async (member: Member) => {\r\n    console.log(\"Make owner:\", member.user.firstName);\r\n    await changeRoleMember(selectedConversation?._id!, member.user._id!);\r\n  };\r\n\r\n  return (\r\n    <div className=\"w-full flex-col\">\r\n      <div className=\"flex items-center justify-between w-full p-2 bg-secondary/50 rounded-md\">\r\n        <p className=\"text-gray-500 text-sm mt-2\">{members.length} members</p>\r\n        <button\r\n          onClick={() => setIsActive(!isActive)}\r\n          className=\"text-sm text-muted-foreground\"\r\n        >\r\n          {isActive ? <ChevronUp /> : <ChevronDown />}\r\n        </button>\r\n      </div>\r\n\r\n      {isActive && (\r\n        <div className=\"w-full flex flex-col items-start justify-start gap-2 p-2 rounded-md mt-2\">\r\n          {sortMembers.map((member) => {\r\n            const isCurrentUser = member.user._id === user?.id;\r\n            const isAdmin = member.role === \"ADMIN\";\r\n            const isOwner = member.role === \"OWNER\";\r\n\r\n            const showPopoverTrigger =\r\n              isCurrentUserAdmin && !isAdmin && !isCurrentUser;\r\n\r\n            return (\r\n              <div\r\n                key={member.user._id}\r\n                className=\"relative flex items-center gap-2 w-full p-2 hover:bg-secondary/40 rounded-md cursor-pointer group\"\r\n                onMouseEnter={() => setHoveredMemberId(member.user._id!)}\r\n                onMouseLeave={() => setHoveredMemberId(null)}\r\n              >\r\n                <Avatar className=\"size-8\">\r\n                  <AvatarImage\r\n                    src={member.user.avatar || \"/avatar.png\"}\r\n                    alt={member.user.firstName}\r\n                  />\r\n                </Avatar>\r\n\r\n                <div className=\"flex flex-col items-start justify-start w-full\">\r\n                  <h1 className=\"text-base font-semibold\">\r\n                    {member.user.firstName + \" \" + member.user.lastName}\r\n                  </h1>\r\n                  {isAdmin && (\r\n                    <span className=\"text-sm text-gray-500\">Admin</span>\r\n                  )}\r\n                  {isOwner && (\r\n                    <span className=\"text-sm text-gray-500\">Owner</span>\r\n                  )}\r\n                </div>\r\n\r\n                {isCurrentUser && (\r\n                  <span className=\"text-sm text-gray-500\">(You)</span>\r\n                )}\r\n\r\n                {/* Hiển thị Popover Trigger nếu đủ điều kiện */}\r\n                {showPopoverTrigger && hoveredMemberId === member.user._id && (\r\n                  <Popover>\r\n                    <PopoverTrigger asChild>\r\n                      <Button\r\n                        variant=\"ghost\"\r\n                        size=\"icon\"\r\n                        className=\"w-6 h-6 text-muted-foreground hover:text-primary\"\r\n                      >\r\n                        <MoreVertical className=\"w-4 h-4\" />\r\n                      </Button>\r\n                    </PopoverTrigger>\r\n                    <PopoverContent className=\"w-40 p-2 text-sm mr-4\">\r\n                      <button\r\n                        onClick={() => handleRemove(member)}\r\n                        className=\"w-full text-left px-2 py-1 rounded hover:bg-red-100 text-red-600\"\r\n                      >\r\n                        Remove\r\n                      </button>\r\n                      <button\r\n                        onClick={() => handleMakeAdmin(member)}\r\n                        className=\"w-full text-left px-2 py-1 rounded hover:bg-blue-100 text-blue-600\"\r\n                      >\r\n                        Make Admin\r\n                      </button>\r\n                      <button\r\n                        onClick={() => handleMakeOwner(member)}\r\n                        className=\"w-full text-left px-2 py-1 rounded hover:bg-green-100 text-green-600\"\r\n                      >\r\n                        Make Owner\r\n                      </button>\r\n                    </PopoverContent>\r\n                  </Popover>\r\n                )}\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ShowGroupMember;\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3635, "column": 0}, "map": {"version":3,"sources":["file://D%3A/cnm_ws/cnm_project_24_25/g5-chatapp-fe/components/common/dialog/AddMemberToGroupDialog.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogHeader,\r\n  DialogTitle,\r\n  DialogFooter,\r\n  DialogClose,\r\n  DialogTrigger,\r\n} from \"@/components/ui/dialog\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { MessageCircle, UserPlus, X } from \"lucide-react\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { useUserStore } from \"@/store/useUserStore\";\r\nimport { useContactStore } from \"@/store/useContactStore\";\r\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\r\nimport { getNameFallBack } from \"@/lib/utils\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { Conversation } from \"@/types\";\r\nimport { useAuthStore } from \"@/store/useAuthStore\";\r\nimport { useConversationStore } from \"@/store/useConversationStore\";\r\n\r\ninterface AddMemberToGroupDialogProps {\r\n  conversation: Conversation | null;\r\n}\r\n\r\nexport function AddMemberToGroupDialog({\r\n  conversation,\r\n}: AddMemberToGroupDialogProps) {\r\n  const [inputValue, setInputValue] = useState(\"\");\r\n  const { contacts, getMyContact, createContact } = useContactStore();\r\n  const {addMemberToGroup} = useConversationStore();\r\n  const { user } = useAuthStore();\r\n  const [selectedUsers, setSelectedUsers] = useState<string[]>([]);\r\n\r\n  const toggleSelectUser = (userId: string) => {\r\n    setSelectedUsers((prev) =>\r\n      prev.includes(userId)\r\n        ? prev.filter((id) => id !== userId)\r\n        : [...prev, userId]\r\n    );\r\n  };\r\n\r\n  const normalizedInput = inputValue.trim().toLowerCase();\r\n\r\n  const filterContacts = contacts\r\n    .map((contact) => {\r\n      // Ưu tiên contact là người bạn đã lưu, không phải chính bạn\r\n      const contactUser =\r\n        contact.contact._id !== user?._id ? contact.contact : contact.user;\r\n\r\n      return contactUser;\r\n    })\r\n    .filter((contactUser) => {\r\n      const fullName =\r\n        `${contactUser.firstName} ${contactUser.lastName}`.toLowerCase();\r\n      const email = contactUser.email?.toLowerCase() || \"\";\r\n      return (\r\n        fullName.includes(normalizedInput) || email.includes(normalizedInput)\r\n      );\r\n    });\r\n\r\n  const checkIsMember = (userId: string) => {\r\n    if (!conversation) return false;\r\n    return conversation.members.some((member) => member.user._id === userId);\r\n  };\r\n\r\n  const handleAddMember = async (userId: string[]) => {\r\n    if (!conversation) return;\r\n    // Add member to group logic here\r\n    console.log(\"Adding member to group: \", userId);\r\n    // You can use the conversation ID and userId to make an API call to add the member\r\n    await addMemberToGroup(\r\n      conversation._id as string,\r\n      userId\r\n    );\r\n  };\r\n\r\n  useEffect(() => {\r\n    getMyContact();\r\n  }, [conversation]);\r\n\r\n  return (\r\n    <Dialog>\r\n      <DialogTrigger asChild>\r\n        <Button\r\n          className=\"rounded-full size-8 flex justify-center items-center\"\r\n          variant=\"secondary\"\r\n        >\r\n          <UserPlus className=\"size-4 text-base-content\" />\r\n        </Button>\r\n      </DialogTrigger>\r\n      <DialogContent className=\"sm:max-w-[400px] h-[60vh] p-0 overflow-hidden\">\r\n        <div className=\"flex flex-col h-full\">\r\n          {/* Header */}\r\n          <div className=\"flex items-center justify-between px-4 py-3 border-b\">\r\n            <DialogTitle className=\"text-base font-semibold\">\r\n              Add member to group\r\n            </DialogTitle>\r\n          </div>\r\n\r\n          {/* Input */}\r\n          <div className=\"p-4 flex-1\">\r\n            <Input\r\n              placeholder=\"Email or username\"\r\n              value={inputValue}\r\n              onChange={(e) => setInputValue(e.target.value)}\r\n              className=\"bg-gray-100\"\r\n            />\r\n          </div>\r\n          {/* result */}\r\n          {/* result */}\r\n          <div className=\"flex-grow h-[240px] overflow-y-auto\">\r\n            {filterContacts &&\r\n              filterContacts.length > 0 &&\r\n              filterContacts.map((user) => (\r\n                <div\r\n                  key={user._id}\r\n                  className=\"flex items-center justify-between gap-2 p-4 border-b border-base-300\"\r\n                >\r\n                  <div className=\"flex items-center gap-2\">\r\n                    {/* <img\r\n                      src={user.avatar || \"/avatar.png\"}\r\n                      alt={user.firstName + \" \" + user.lastName}\r\n                      className=\"w-10 h-10 rounded-full\"\r\n                    /> */}\r\n                    <Avatar>\r\n                      <AvatarImage\r\n                        src={user.avatar || \"/avatar.png\"}\r\n                      ></AvatarImage>\r\n                      <AvatarFallback>\r\n                        {getNameFallBack(\r\n                          user.firstName || \"\",\r\n                          user.lastName || \"\"\r\n                        )}\r\n                      </AvatarFallback>\r\n                    </Avatar>\r\n                    <div>\r\n                      <p className=\"text-sm font-semibold\">\r\n                        {user.firstName + \" \" + user.lastName}\r\n                      </p>\r\n                      <p className=\"text-xs text-base-content\">{user.email}</p>\r\n                    </div>\r\n                  </div>\r\n                  {checkIsMember(user._id as string) ? (\r\n                    <span className=\"text-xs text-muted-foreground\">\r\n                      In group\r\n                    </span>\r\n                  ) : (\r\n                    <input\r\n                      type=\"checkbox\"\r\n                      className=\"form-checkbox\"\r\n                      checked={selectedUsers.includes(user._id!)}\r\n                      onChange={() => toggleSelectUser(user._id!)}\r\n                    />\r\n                  )}\r\n                </div>\r\n              ))}\r\n          </div>\r\n\r\n          {/* Footer */}\r\n          <DialogFooter className=\"bg-gray-50 px-4 py-3 border-t flex justify-end gap-2\">\r\n            <DialogClose asChild>\r\n              <Button variant=\"ghost\">Cancel</Button>\r\n            </DialogClose>\r\n            <Button\r\n              disabled={selectedUsers.length === 0}\r\n              onClick={() => {\r\n                handleAddMember(selectedUsers);\r\n                setSelectedUsers([]);\r\n                setInputValue(\"\");\r\n              }}\r\n            >\r\n              Add ({selectedUsers.length})\r\n            </Button>\r\n          </DialogFooter>\r\n        </div>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3930, "column": 0}, "map": {"version":3,"sources":["file://D%3A/cnm_ws/cnm_project_24_25/g5-chatapp-fe/components/common/dialog/CheckAdminLeaveGroupDialog.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogHeader,\r\n  DialogTitle,\r\n  DialogFooter,\r\n  DialogClose,\r\n  DialogTrigger,\r\n} from \"@/components/ui/dialog\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { LogOutIcon, MessageCircle, UserPlus, X } from \"lucide-react\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { useUserStore } from \"@/store/useUserStore\";\r\nimport { useContactStore } from \"@/store/useContactStore\";\r\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\r\nimport { getNameFallBack } from \"@/lib/utils\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { Conversation } from \"@/types\";\r\nimport { useAuthStore } from \"@/store/useAuthStore\";\r\nimport { useConversationStore } from \"@/store/useConversationStore\";\r\n\r\ninterface CheckAdminLeaveGroupDialogProps {\r\n  conversation: Conversation | null;\r\n}\r\n\r\nexport function CheckAdminLeaveGroupDialog({\r\n  conversation,\r\n}: CheckAdminLeaveGroupDialogProps) {\r\n  const [inputValue, setInputValue] = useState(\"\");\r\n  const { changeAdminGroup } = useConversationStore();\r\n  const { user } = useAuthStore();\r\n  const [selectedUserId, setSelectedUserId] = useState<string | null>(null);\r\n\r\n  const toggleSelectUser = (userId: string) => {\r\n    setSelectedUserId((prev) => (prev === userId ? null : userId));\r\n  };\r\n\r\n  const normalizedInput = inputValue.trim().toLowerCase();\r\n\r\n  const filterContacts = conversation?.members\r\n  .filter((member) => {\r\n    const fullName =\r\n      `${member.user.firstName} ${member.user.lastName}`.toLowerCase();\r\n    const email = member.user.email?.toLowerCase() || \"\";\r\n    const matchesQuery =\r\n      fullName.includes(normalizedInput) || email.includes(normalizedInput);\r\n\r\n    return matchesQuery && member.role !== \"ADMIN\"; // 👈 Exclude admins\r\n  })\r\n  .map((member) => member.user);\r\n\r\n\r\n\r\n  useEffect(() => {\r\n    // getMyContact();\r\n  }, [conversation]);\r\n\r\n  return (\r\n    <Dialog>\r\n      <DialogTrigger asChild>\r\n        <Button\r\n          className=\"rounded-full size-8 flex justify-center items-center\"\r\n          variant=\"destructive\"\r\n        >\r\n          <LogOutIcon className=\"size-4 text-base-content\" />\r\n        </Button>\r\n      </DialogTrigger>\r\n      <DialogContent className=\"sm:max-w-[400px] h-[60vh] p-0 overflow-hidden\">\r\n        <div className=\"flex flex-col h-full\">\r\n          {/* Header */}\r\n          <div className=\"flex items-center justify-between px-4 py-3 border-b\">\r\n            <DialogTitle className=\"text-base font-semibold\">\r\n              Change admin before leaving group\r\n            </DialogTitle>\r\n          </div>\r\n\r\n          {/* Input */}\r\n          <div className=\"p-4 flex-1\">\r\n            <Input\r\n              placeholder=\"Email or username\"\r\n              value={inputValue}\r\n              onChange={(e) => setInputValue(e.target.value)}\r\n              className=\"bg-gray-100\"\r\n            />\r\n          </div>\r\n          {/* result */}\r\n          {/* result */}\r\n          <div className=\"flex-grow h-[240px] overflow-y-auto\">\r\n            {filterContacts &&\r\n              filterContacts.length > 0 &&\r\n              filterContacts.map((user) => (\r\n                <div\r\n                  key={user._id}\r\n                  className=\"flex items-center justify-between gap-2 p-4 border-b border-base-300\"\r\n                >\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <Avatar>\r\n                      <AvatarImage\r\n                        src={user.avatar || \"/avatar.png\"}\r\n                      ></AvatarImage>\r\n                      <AvatarFallback>\r\n                        {getNameFallBack(\r\n                          user.firstName || \"\",\r\n                          user.lastName || \"\"\r\n                        )}\r\n                      </AvatarFallback>\r\n                    </Avatar>\r\n                    <div>\r\n                      <p className=\"text-sm font-semibold\">\r\n                        {user.firstName + \" \" + user.lastName}\r\n                      </p>\r\n                      <p className=\"text-xs text-base-content\">{user.email}</p>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    className=\"form-checkbox\"\r\n                    checked={selectedUserId === user._id}\r\n                    onChange={() => toggleSelectUser(user._id!)}\r\n                  />\r\n                </div>\r\n              ))}\r\n          </div>\r\n\r\n          {/* Footer */}\r\n          <DialogFooter className=\"bg-gray-50 px-4 py-3 border-t flex justify-end gap-2\">\r\n            <DialogClose asChild>\r\n              <Button variant=\"ghost\">Cancel</Button>\r\n            </DialogClose>\r\n            <Button\r\n              disabled={!selectedUserId}\r\n              onClick={async () => {\r\n                if (selectedUserId && conversation) {\r\n                  await changeAdminGroup(conversation._id, selectedUserId);\r\n                  setSelectedUserId(null);\r\n                  setInputValue(\"\");\r\n                }\r\n              }}\r\n            >\r\n              Change\r\n            </Button>\r\n          </DialogFooter>\r\n        </div>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 4195, "column": 0}, "map": {"version":3,"sources":["file://D%3A/cnm_ws/cnm_project_24_25/g5-chatapp-fe/app/%28root%29/conversations/%5BconversationId%5D/_components/info/ConversationInfo.tsx"],"sourcesContent":["\"use client\";\r\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Card } from \"@/components/ui/card\";\r\nimport { cn, getNameFallBack } from \"@/lib/utils\";\r\nimport { useAuthStore } from \"@/store/useAuthStore\";\r\nimport { useConversationStore } from \"@/store/useConversationStore\";\r\nimport { Conversation, User } from \"@/types\";\r\nimport {\r\n  Bell,\r\n  Download,\r\n  FileText,\r\n  LogOutIcon,\r\n  Search,\r\n  Trash,\r\n  Trash2,\r\n  UserPlus,\r\n} from \"lucide-react\";\r\nimport Image from \"next/image\";\r\nimport Link from \"next/link\";\r\nimport React, { useEffect } from \"react\";\r\nimport ShowGroupMember from \"./ShowGroupMember\";\r\nimport { useMessageStore } from \"@/store/useMessageStore\";\r\nimport { AddMemberToGroupDialog } from \"@/components/common/dialog/AddMemberToGroupDialog\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { CheckAdminLeaveGroupDialog } from \"@/components/common/dialog/CheckAdminLeaveGroupDialog\";\r\n\r\ntype Props = {\r\n  isOpen: boolean;\r\n  setOpen: (open: boolean) => void;\r\n  userSelected?: User | null;\r\n  isGroup?: boolean;\r\n};\r\n\r\nfunction ConversationInfo({ isOpen, setOpen, userSelected, isGroup }: Props) {\r\n  const { selectedConversation, leaveGroup, dissolveGroup } =\r\n    useConversationStore();\r\n  const [showGroupMember, setShowGroupMember] = React.useState(false);\r\n  const { user } = useAuthStore();\r\n  const { messages } = useMessageStore();\r\n  const isAdmin = selectedConversation?.members.find(\r\n    (member) => member.user._id === user?.id && member.role === \"ADMIN\"\r\n  );\r\n  const router = useRouter();\r\n  const mediaFiles = messages\r\n    .filter(\r\n      (message) =>\r\n        (message.type === \"IMAGE\" || message.type === \"VIDEO\") &&\r\n        Array.isArray(message.files)\r\n    )\r\n    .flatMap((message) => message.files!); // dấu `!` vì ta đã kiểm tra ở trên\r\n\r\n  const files = messages\r\n    .filter(\r\n      (message) =>\r\n        (message.type === \"FILE\" || message.type === \"DOCUMENT\") &&\r\n        Array.isArray(message.files)\r\n    )\r\n    .flatMap((message) => message.files!); // dấu `!` vì ta đã kiểm tra ở trên\r\n\r\n  useEffect(() => {\r\n    console.log(\"Media files:\", mediaFiles);\r\n    console.log(\"Files:\", files);\r\n  }, [selectedConversation]);\r\n\r\n  const handleLeaveGroup = async () => {\r\n    if (!selectedConversation) return;\r\n    await leaveGroup(selectedConversation._id!);\r\n    router.push(\"/conversations\");\r\n  };\r\n\r\n  const handleDissolveGroup = async () => {\r\n    if (!selectedConversation) return;\r\n    await dissolveGroup(selectedConversation._id!);\r\n    router.push(\"/conversations\");\r\n  };\r\n\r\n  return (\r\n    <Card\r\n      className={cn(\r\n        \"w-full p-2 rounded-lg overflow-y-scroll no-scrollbar\",\r\n        isOpen ? \"col-span-3\" : \"hidden\"\r\n      )}\r\n    >\r\n      {/* info */}\r\n      <div className=\"flex flex-col gap-2 justify-center items-center mt-6\">\r\n        <Avatar className=\"h-16 w-16\">\r\n          {isGroup ? (\r\n            <AvatarImage\r\n              src={selectedConversation?.profilePicture || \"/group.jpg\"}\r\n              alt=\"Group\"\r\n            />\r\n          ) : (\r\n            <AvatarImage\r\n              src={userSelected?.avatar || \"/avatar.png\"}\r\n              alt=\"User\"\r\n            />\r\n          )}\r\n          <AvatarFallback>\r\n            {getNameFallBack(\r\n              userSelected?.firstName || \"\",\r\n              userSelected?.lastName || \"\"\r\n            )}\r\n          </AvatarFallback>\r\n        </Avatar>\r\n        {/* <div> */}\r\n        {isGroup ? (\r\n          <h2 className=\"font-semibold\">{selectedConversation?.name}</h2>\r\n        ) : (\r\n          <h2 className=\"font-semibold\">\r\n            {userSelected?.firstName + \" \" + userSelected?.lastName}\r\n          </h2>\r\n        )}\r\n\r\n        {/* button */}\r\n        <div className=\"mt-2 flex justify-evenly items-start w-full\">\r\n          {!isGroup && (\r\n            <>\r\n              <div className=\"flex flex-col items-center gap-1\">\r\n                <Button\r\n                  className=\"rounded-full size-8 flex justify-center items-center\"\r\n                  variant=\"secondary\"\r\n                >\r\n                  <Bell className=\"size-4 text-base-content\" />\r\n                </Button>\r\n                <span className=\"text-base-content text-sm\">Mute</span>\r\n              </div>\r\n\r\n              <div className=\"flex flex-col items-center gap-1\">\r\n                <Button\r\n                  className=\"rounded-full size-8 flex justify-center items-center\"\r\n                  variant=\"secondary\"\r\n                >\r\n                  <Search className=\"size-4 text-base-content\" />\r\n                </Button>\r\n                <span className=\"text-base-content text-sm\">Search</span>\r\n              </div>\r\n            </>\r\n          )}\r\n          {isGroup && (\r\n            <>\r\n              <div className=\"flex flex-col items-center gap-1\">\r\n                {/* <Button\r\n                  className=\"rounded-full size-8 flex justify-center items-center\"\r\n                  variant=\"secondary\"\r\n                >\r\n                  <UserPlus className=\"size-4 text-base-content\" />\r\n                </Button> */}\r\n                <AddMemberToGroupDialog conversation={selectedConversation!} />\r\n                <span className=\"text-base-content text-sm\">Add</span>\r\n              </div>\r\n              <div className=\"flex flex-col items-center gap-1\">\r\n                {isAdmin ? (\r\n                  <CheckAdminLeaveGroupDialog\r\n                    conversation={selectedConversation!}\r\n                  />\r\n                ) : (\r\n                  <Button\r\n                    className=\"rounded-full size-8 flex justify-center items-center\"\r\n                    variant=\"destructive\"\r\n                    onClick={handleLeaveGroup}\r\n                  >\r\n                    <LogOutIcon className=\"size-4 text-base-content\" />\r\n                  </Button>\r\n                )}\r\n                <span className=\"text-base-content text-sm\">Leave</span>\r\n              </div>\r\n              {isAdmin && (\r\n                <div className=\"flex flex-col items-center gap-1\">\r\n                  <Button\r\n                    className=\"rounded-full size-8 flex justify-center items-center\"\r\n                    variant=\"destructive\"\r\n                    onClick={handleDissolveGroup}\r\n                  >\r\n                    <Trash2 className=\"size-4 text-base-content\" />\r\n                  </Button>\r\n                  <span className=\"text-base-content text-sm\">Dissolve</span>\r\n                </div>\r\n              )}\r\n            </>\r\n          )}\r\n        </div>\r\n      </div>\r\n      {/*  */}\r\n      {/* members */}\r\n      {isGroup && (\r\n        <div className=\"mt-4 border-t pt-4\">\r\n          <h3 className=\"text-base font-medium\">Group member</h3>\r\n\r\n          <ShowGroupMember\r\n            members={[...(selectedConversation?.members || [])]}\r\n            isActive={showGroupMember}\r\n            setIsActive={setShowGroupMember}\r\n          />\r\n        </div>\r\n      )}\r\n      {/* Photos/Videos */}\r\n      <div className=\"mt-4 border-t pt-4\">\r\n        <h3 className=\"text-base font-medium\">Photos/Videos</h3>\r\n        {mediaFiles.length > 0 ? (\r\n          <>\r\n            <div className=\"grid grid-cols-3 gap-2 mt-2\">\r\n              {mediaFiles.map((file, index) => {\r\n                const isVideo = file.url.endsWith(\".mp4\");\r\n                const isImage = file.url.endsWith(\".jpg\") || file.url.endsWith(\".png\");\r\n                if (isVideo) {\r\n                  return (\r\n                    <video\r\n                      key={index}\r\n                      src={file.url}\r\n                      controls\r\n                      className=\"rounded-md\"\r\n                      width={100}\r\n                      height={100}\r\n                    />\r\n                  );\r\n                }\r\n                return (\r\n                  <Image\r\n                    key={index}\r\n                    src={file.url}\r\n                    alt=\"Photo\"\r\n                    width={100}\r\n                    height={100}\r\n                    className=\"rounded-md\"\r\n                  />\r\n                );\r\n              })}\r\n            </div>\r\n            {/* <Button variant=\"outline\" className=\"w-full mt-2\">\r\n              View all\r\n            </Button> */}\r\n          </>\r\n        ) : (\r\n          <p className=\"text-gray-500 text-sm mt-2\">\r\n            No photos/videos available.\r\n          </p>\r\n        )}\r\n      </div>\r\n      {/* Files */}\r\n      <div className=\"mt-4 border-t pt-4\">\r\n        <h3 className=\"text-base font-medium\">Files</h3>\r\n        {files.length > 0 ? (\r\n          <>\r\n            {files.map((file, index) => (\r\n              <div\r\n                key={index}\r\n                className=\"flex items-center p-2 border rounded-lg mt-2\"\r\n              >\r\n                <FileText className=\"w-6 h-6 text-gray-500 mr-2\" />\r\n                <div className=\"flex-1\">\r\n                  <p className=\"text-sm font-medium\">{file.fileName}</p>\r\n                  {/* <p className=\"text-xs text-gray-500\">\r\n                    {file.url} • {file.date}\r\n                  </p> */}\r\n                </div>\r\n                {/* <Link\r\n                  href={file.url}\r\n                  target=\"_blank\"\r\n                  className=\"text-blue-500 text-sm\"\r\n                >\r\n                  <Download className=\"w-6 h-6\" />\r\n                </Link> */}\r\n              </div>\r\n            ))}\r\n            {/* <Button variant=\"outline\" className=\"w-full mt-2\">\r\n              View all\r\n            </Button> */}\r\n          </>\r\n        ) : (\r\n          <p className=\"text-gray-500 text-sm mt-2\">No files available.</p>\r\n        )}\r\n      </div>\r\n    </Card>\r\n  );\r\n}\r\n\r\nexport default ConversationInfo;\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 4671, "column": 0}, "map": {"version":3,"sources":["file://D%3A/cnm_ws/cnm_project_24_25/g5-chatapp-fe/app/%28root%29/conversations/%5BconversationId%5D/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { Info, Loader2, Phone, Video } from \"lucide-react\";\r\nimport React, { use, useEffect, useState } from \"react\";\r\nimport Header from \"./_components/Header\";\r\nimport Body from \"./_components/body/Body\";\r\nimport ChatInput from \"./_components/input/ChatInput\";\r\nimport ConversationContainer from \"@/components/common/conversation/ConversationContainer\";\r\nimport ConversationInfo from \"./_components/info/ConversationInfo\";\r\nimport { useConversationStore } from \"@/store/useConversationStore\";\r\nimport { root } from \"postcss\";\r\nimport { useAuthStore } from \"@/store/useAuthStore\";\r\nimport { useCallStore } from \"@/store/useCallStore\";\r\n\r\ntype Props = {\r\n  params: Promise<{\r\n    conversationId: string;\r\n  }>;\r\n};\r\n\r\nfunction ConversationPage({ params }: Props) {\r\n  const [conversationId, setConversationId] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    const resolveParams = async () => {\r\n      const resolvedParams = await params;\r\n      setConversationId(resolvedParams.conversationId);\r\n    };\r\n\r\n    resolveParams();\r\n  }, [params]);\r\n\r\n  const { selectedConversation, getConversation } = useConversationStore();\r\n\r\n  const { user } = useAuthStore();\r\n\r\n  const { handleCall } = useCallStore();\r\n\r\n  useEffect(() => {\r\n    console.log(\"Conversation ID:\", conversationId);\r\n    if (conversationId) {\r\n      getConversation(conversationId);\r\n    }\r\n  }, [conversationId, getConversation]);\r\n\r\n  const userSelected = selectedConversation?.members.find(\r\n    (member) => member.user._id !== user?.id\r\n  );\r\n\r\n  const [removeFriendDialogOpen, setRemoveFriendDialogOpen] = useState(false);\r\n  const [deleteGroupDialogOpen, setDeleteGroupDialogOpen] = useState(false);\r\n  const [leaveGroupDialogOpen, setLeaveGroupDialogOpen] = useState(false);\r\n  const [callType, setCallType] = useState<\"audio\" | \"video\" | null>(null);\r\n\r\n  const [isOpenRightBar, setIsOpenRightBar] = useState(false);\r\n\r\n  if (conversationId === null) {\r\n    return (\r\n      <div className=\"w-full h-full flex items-center justify-center\">\r\n        <Loader2 className=\"w-8 h-8 animate-spin\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (conversationId === undefined) {\r\n    return (\r\n      <p className=\"w-full h-full flex items-center justify-center\">\r\n        Select/start a conversation to get started!\r\n      </p>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <ConversationContainer>\r\n      {/* <RemoveFriendDialog\r\n        conversationId={conversationId}\r\n        open={removeFriendDialogOpen}\r\n        setOpen={setRemoveFriendDialogOpen}\r\n      /> */}\r\n      <div\r\n        className={`flex flex-col justify-between ${\r\n          isOpenRightBar ? \"col-span-6\" : \"col-span-9\"\r\n        }`}\r\n      >\r\n        {selectedConversation?.isGroup ? (\r\n          <Header\r\n            isGroup={selectedConversation?.isGroup || false}\r\n            name={selectedConversation?.name}\r\n            imageUrl={selectedConversation?.profilePicture || \"\"}\r\n            numMembers={selectedConversation?.members.length}\r\n            options={[\r\n              // {\r\n              //   label: \"Voice call\",\r\n              //   icon: <Phone />,\r\n              //   onClick: () =>\r\n              //     handleCall(conversationId, selectedConversation.isGroup),\r\n              // },\r\n              {\r\n                label: \"Video call\",\r\n                icon: <Video />,\r\n                onClick: () =>\r\n                  handleCall(conversationId, selectedConversation.isGroup),\r\n              },\r\n              {\r\n                label: \"Info\",\r\n                icon: <Info />,\r\n                onClick: () => setIsOpenRightBar(!isOpenRightBar),\r\n              },\r\n            ]}\r\n          />\r\n        ) : (\r\n          <Header\r\n            isGroup={selectedConversation?.isGroup || false}\r\n            userId={userSelected?.user._id || \"\"}\r\n            firstName={userSelected?.user.firstName || \"\"}\r\n            lastName={userSelected?.user.lastName || \"\"}\r\n            imageUrl={userSelected?.user.avatar || \"\"}\r\n            options={[\r\n              // {\r\n              //   label: \"Voice call\",\r\n              //   icon: <Phone />,\r\n              //   onClick: () =>\r\n              //     handleCall(conversationId, selectedConversation!.isGroup),\r\n              // },\r\n              {\r\n                label: \"Video call\",\r\n                icon: <Video />,\r\n                onClick: () =>\r\n                  handleCall(conversationId, selectedConversation!.isGroup),\r\n              },\r\n              {\r\n                label: \"Info\",\r\n                icon: <Info />,\r\n                onClick: () => setIsOpenRightBar(!isOpenRightBar),\r\n              },\r\n            ]}\r\n          />\r\n        )}\r\n\r\n        <Body />\r\n        <ChatInput />\r\n      </div>\r\n      {selectedConversation?.isGroup ? (\r\n        <ConversationInfo\r\n          isOpen={isOpenRightBar}\r\n          setOpen={setIsOpenRightBar}\r\n          isGroup={true}\r\n        />\r\n      ) : (\r\n        <ConversationInfo\r\n          isOpen={isOpenRightBar}\r\n          setOpen={setIsOpenRightBar}\r\n          userSelected={userSelected?.user || null}\r\n          isGroup={false}\r\n        />\r\n      )}\r\n    </ConversationContainer>\r\n  );\r\n}\r\n\r\nexport default ConversationPage;\r\n"],"names":[],"mappings":"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","debugId":null}}]
}